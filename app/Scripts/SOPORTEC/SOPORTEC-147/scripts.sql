USE BelcorpPeru
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetCuponesProgramaNuevas]') AND type in (N'P', N'PC')) 
	DROP PROCEDURE [dbo].GetCuponesProgramaNuevas
GO

create procedure dbo.GetCuponesProgramaNuevas
@CampaniaID int
as
/*
dbo.GetCuponesProgramaNuevas 201805
dbo.GetCuponesProgramaNuevas 201806
*/
begin

select CodigoCupon
from ods.cuponesprogramanuevas 
where 
	CodigoVenta is not null 
	and Campana = @CampaniaID

end

go

USE BelcorpMexico
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetCuponesProgramaNuevas]') AND type in (N'P', N'PC')) 
	DROP PROCEDURE [dbo].GetCuponesProgramaNuevas
GO

create procedure dbo.GetCuponesProgramaNuevas
@CampaniaID int
as
/*
dbo.GetCuponesProgramaNuevas 201805
dbo.GetCuponesProgramaNuevas 201806
*/
begin

select CodigoCupon
from ods.cuponesprogramanuevas 
where 
	CodigoVenta is not null 
	and Campana = @CampaniaID

end

go

USE BelcorpColombia
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetCuponesProgramaNuevas]') AND type in (N'P', N'PC')) 
	DROP PROCEDURE [dbo].GetCuponesProgramaNuevas
GO

create procedure dbo.GetCuponesProgramaNuevas
@CampaniaID int
as
/*
dbo.GetCuponesProgramaNuevas 201805
dbo.GetCuponesProgramaNuevas 201806
*/
begin

select CodigoCupon
from ods.cuponesprogramanuevas 
where 
	CodigoVenta is not null 
	and Campana = @CampaniaID

end

go

USE BelcorpSalvador
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetCuponesProgramaNuevas]') AND type in (N'P', N'PC')) 
	DROP PROCEDURE [dbo].GetCuponesProgramaNuevas
GO

create procedure dbo.GetCuponesProgramaNuevas
@CampaniaID int
as
/*
dbo.GetCuponesProgramaNuevas 201805
dbo.GetCuponesProgramaNuevas 201806
*/
begin

select CodigoCupon
from ods.cuponesprogramanuevas 
where 
	CodigoVenta is not null 
	and Campana = @CampaniaID

end

go

USE BelcorpPuertoRico
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetCuponesProgramaNuevas]') AND type in (N'P', N'PC')) 
	DROP PROCEDURE [dbo].GetCuponesProgramaNuevas
GO

create procedure dbo.GetCuponesProgramaNuevas
@CampaniaID int
as
/*
dbo.GetCuponesProgramaNuevas 201805
dbo.GetCuponesProgramaNuevas 201806
*/
begin

select CodigoCupon
from ods.cuponesprogramanuevas 
where 
	CodigoVenta is not null 
	and Campana = @CampaniaID

end

go

USE BelcorpPanama
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetCuponesProgramaNuevas]') AND type in (N'P', N'PC')) 
	DROP PROCEDURE [dbo].GetCuponesProgramaNuevas
GO

create procedure dbo.GetCuponesProgramaNuevas
@CampaniaID int
as
/*
dbo.GetCuponesProgramaNuevas 201805
dbo.GetCuponesProgramaNuevas 201806
*/
begin

select CodigoCupon
from ods.cuponesprogramanuevas 
where 
	CodigoVenta is not null 
	and Campana = @CampaniaID

end

go

USE BelcorpGuatemala
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetCuponesProgramaNuevas]') AND type in (N'P', N'PC')) 
	DROP PROCEDURE [dbo].GetCuponesProgramaNuevas
GO

create procedure dbo.GetCuponesProgramaNuevas
@CampaniaID int
as
/*
dbo.GetCuponesProgramaNuevas 201805
dbo.GetCuponesProgramaNuevas 201806
*/
begin

select CodigoCupon
from ods.cuponesprogramanuevas 
where 
	CodigoVenta is not null 
	and Campana = @CampaniaID

end

go

USE BelcorpEcuador
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetCuponesProgramaNuevas]') AND type in (N'P', N'PC')) 
	DROP PROCEDURE [dbo].GetCuponesProgramaNuevas
GO

create procedure dbo.GetCuponesProgramaNuevas
@CampaniaID int
as
/*
dbo.GetCuponesProgramaNuevas 201805
dbo.GetCuponesProgramaNuevas 201806
*/
begin

select CodigoCupon
from ods.cuponesprogramanuevas 
where 
	CodigoVenta is not null 
	and Campana = @CampaniaID

end

go

USE BelcorpDominicana
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetCuponesProgramaNuevas]') AND type in (N'P', N'PC')) 
	DROP PROCEDURE [dbo].GetCuponesProgramaNuevas
GO

create procedure dbo.GetCuponesProgramaNuevas
@CampaniaID int
as
/*
dbo.GetCuponesProgramaNuevas 201805
dbo.GetCuponesProgramaNuevas 201806
*/
begin

select CodigoCupon
from ods.cuponesprogramanuevas 
where 
	CodigoVenta is not null 
	and Campana = @CampaniaID

end

go

USE BelcorpCostaRica
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetCuponesProgramaNuevas]') AND type in (N'P', N'PC')) 
	DROP PROCEDURE [dbo].GetCuponesProgramaNuevas
GO

create procedure dbo.GetCuponesProgramaNuevas
@CampaniaID int
as
/*
dbo.GetCuponesProgramaNuevas 201805
dbo.GetCuponesProgramaNuevas 201806
*/
begin

select CodigoCupon
from ods.cuponesprogramanuevas 
where 
	CodigoVenta is not null 
	and Campana = @CampaniaID

end

go

USE BelcorpChile
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetCuponesProgramaNuevas]') AND type in (N'P', N'PC')) 
	DROP PROCEDURE [dbo].GetCuponesProgramaNuevas
GO

create procedure dbo.GetCuponesProgramaNuevas
@CampaniaID int
as
/*
dbo.GetCuponesProgramaNuevas 201805
dbo.GetCuponesProgramaNuevas 201806
*/
begin

select CodigoCupon
from ods.cuponesprogramanuevas 
where 
	CodigoVenta is not null 
	and Campana = @CampaniaID

end

go

USE BelcorpBolivia
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[GetCuponesProgramaNuevas]') AND type in (N'P', N'PC')) 
	DROP PROCEDURE [dbo].GetCuponesProgramaNuevas
GO

create procedure dbo.GetCuponesProgramaNuevas
@CampaniaID int
as
/*
dbo.GetCuponesProgramaNuevas 201805
dbo.GetCuponesProgramaNuevas 201806
*/
begin

select CodigoCupon
from ods.cuponesprogramanuevas 
where 
	CodigoVenta is not null 
	and Campana = @CampaniaID

end

go

