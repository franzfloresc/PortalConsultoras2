@model Portal.Consultoras.Web.Models.AdministrarHistorialModel

@{
    ViewBag.Title = "Administrar Historias";
    string imagenVacia = "prod_grilla_vacio.png";
}
<script src="@Url.Content("~/Scripts/fileuploader.js")" type="text/javascript"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="@Url.Content("~/Content/Css/Toast/jquery.toast.min.css")" rel="stylesheet" />

<style>
    .elements {
        padding: 0px 0 7px;
    }
</style>
<script type="text/javascript">
    jQuery(document).ready(function () {
        $(".qq-upload-list").css("display", "none");
    });

    function OnSuccess(result) {
        alert(result.message);
        $('#NombreImagen').val("");
    }
    function AbrirSplash() {
        waitingDialog({});
    }

    function CerrarSplash() {
        closeWaitingDialog();
    }
</script>

@using (Ajax.BeginForm("Update", new AjaxOptions
{
    HttpMethod = "Post",
    OnSuccess = "OnSuccess",
    OnBegin = "AbrirSplash()",
    OnComplete = "CerrarSplash()"
}))
{
    <div class="wrap_cab">
        <div class="filtros2">
            <div class="elements">

                <div class="div-3">
                    <div class="titG">Campaña:</div>
                    <div class="selectP2 borde_redondeado">
                        @Html.DropDownListFor(model => model.DesdeCampania, new SelectList(Model.ListaCampanias, "CampaniaID", "Codigo"), new { id = "ddlCampania" })
                    </div>
                </div>

                <div class="div-3">
                    <div class="titG">
                        <span id="">Imagen:</span>
                        <h6 id="">(@Model.Ancho x @Model.Alto pixeles)</h6>
                        <h6>La imagen debe ser redonda</h6>
                    </div>

                    <div class="fondo_left">
                        <div class="fondo_image">
                            @Html.HiddenFor(model => model.IdContenido)
                            @Html.HiddenFor(model => model.Codigo)
                            @Html.HiddenFor(model => model.NombreImagen, new { id = "NombreImagen", imageextension = "jpg", imagewidth = @Model.Ancho, imageheight = @Model.Alto, messageSize = "Las medidas no son correctas. Vuelve a intentar, por favor.", messageFormat = "El formato no es correcto. Vuelve a intentar, por favor." })

                            <img id="preview" src="@Model.NombreImagenAnterior" alt="Imagen Previa" style="max-width:80px; max-height:100px;" />
                        </div>
                    </div>
                    <div class="fondo_right">
                        <div class="div-3" style="margin-top:-25px;">
                            <div class="input_validar">
                                <div id="file-uploader">
                                </div>

                            </div>
                        </div>

                        <div class="div-3">
                            <div class="input_search">
                                <input type="submit" value="Guardar" />
                            </div>
                        </div>

                    </div>


                </div>



            </div>
        </div>
    </div>
}

<div class="wrap_cab">
    <div class="filtros2">
        <div class="elements">
            <div class="div-2">
                <h1><span>Historias</span></h1>
            </div>
            <div class="div-3">
                <div class="input_horizontal">
                    <input type="button" name="btnNuevo" id="btnNuevo" value="Nuevo" onclick="javaScript: NuevoDetalle('@Model.IdContenido');" />
                    @*<input type="submit" value="Cargar" />*@
                </div>
            </div>
            <div class="container clearfix">
                <div class="border-wrapper">
                    <table id="tblHistoriaDet"></table>
                    <div id="pagerHistoriaDet"></div>
                </div>
            </div>
        </div>
    </div>
</div>


<div id="DialogMantenimientoHistoriaDatos" style="display: none;">
    <div class="Content_modal" id="dialog-content-historia-datos"></div>
</div>

<div id="DialogMantenimientoDetalle" style="display: none;">
    <div class="Content_modal" id="dialog-content-detalle"></div>
</div>

<div id="DialogImagen" style="display: none;">
    <div class="Content_modal" id="dialog-content-imagen"></div>
</div>

<div id="DialogEditarContenedor" style="display: none;">
    <div class="Content_modal" id="dialog-editar-contenedor"></div>
</div>

<script type="text/javascript">
        var urlListarCampanias = '@Url.Action("ObtenerCampaniasPorUsuario", "BaseAdm")';
        var rutaImagenEdit = '@Url.Content("~/Content/Images/Edit.png")';
        var rutaImagenDelete = '@Url.Content("~/Content/Images/Delete.png")';
        var rutaFileUpload = '@Url.Action("ImageLanzamientoUpload", "FileUpload")';
        var rutaTemporal = '@Url.Content("~/Content/Temporales/")';
        var urlS3 = '@ViewBag.UrlS3';
        var urlDetalleS3 = '@ViewBag.UrlDetalleS3';
        var rutaImagenVacia = '@Url.Content("~/Content/Images/Question.png")';
        var rowNumList = @Model.CantidadContenido;
</script>

<script src="@Url.Content("~/Scripts/handlebars.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.paging.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.toast.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.form.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/AdminContenido/ToastHelper.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/AdminContenido/Paginador.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/AdminContenido/MatrizComercialFileUpload.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/AdminContenido/AdministrarHistorias/AdminHistoria.js")"></script>
<script src="@Url.Content("~/Scripts/AdminContenido/AdministrarHistorias/AdminHistoriaDatos.js")"></script>