@using Portal.Consultoras.Common
@model Portal.Consultoras.Web.Models.DetalleEstrategiaFichaModel

@{
    Layout = "~/Views/Shared/_MainLayoutContenedor.cshtml";
}

@Html.Partial("FichaTemplate")
@Html.Partial("~/Views/RevistaDigital/template-mensaje-bloqueado.cshtml", Model.MensajeProductoBloqueado)

@section scripts{

    @System.Web.Optimization.Scripts.Render("~/Bundle/Js/Mixto/EstrategiaAgregar")
    @System.Web.Optimization.Scripts.Render("~/Bundle/Js/Mixto/Ficha")

    <script type="text/javascript">
        AbrirLoad();

        var fichaModule;
        var carruselModule;
        var tieneCarrusel = '@Model.TieneCarrusel';

        $(document).ready(function () {
            fichaModule = FichaModule({
                localStorageModule: LocalStorageModule(),
                palanca: "@Model.Palanca",
                campania: "@Model.Campania",
                cuv: "@Model.Cuv",
                origen: "@Model.OrigenUrl",
                tieneSession: "@Model.TieneSession",
                urlObtenerComponentes: '@Url.Action("ObtenerComponentes", "DetalleEstrategia")'
            });
            fichaModule.Inicializar();

            if (tieneCarrusel == "True")
            {
                carruselModule = CarruselModule({
                    palanca: "@Model.Palanca",
                    campania: "@Model.Campania",
                    cuv: "@Model.Cuv",
                    urlDataCarrusel: '@Url.Action("FichaObtenerProductosCarrusel", "Estrategia", new { Area = "" })',
                    idPlantillaProducto: "#producto-landing-template",
                    divCarruselContenedor: "#divFichaCarrusel",
                    idTituloCarrusel: "#tituloCarrusel",
                    divCarruselProducto: "#divFichaCarruselProducto",
                    OrigenPedidoWeb: "@Model.OrigenUrl"
                });
                carruselModule.Inicializar();
            }

            CerrarLoad();
        });

        $(document).ajaxStop(function () { });
    </script>
}