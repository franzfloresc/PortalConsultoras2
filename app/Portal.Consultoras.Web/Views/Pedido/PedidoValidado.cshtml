@using Portal.Consultoras.Common
@model Portal.Consultoras.Web.Models.PedidoDetalleModel

@{
    ViewBag.Title = "Pedido Reservado";
}

@section styles{
    <link href="@Url.Content("~/Content/Css/Site/style-pedido.css")" rel="stylesheet" />
}

<div class="franja_negra pedidoReservado"></div>
<div class="wrapper_general2">
    @if (ViewBag.ZonaNuevoPROL == true)
    {
        <h1 class="titulo_principal_interiores pedido_left">PEDIDO <strong>RESERVADO CON ÉXITO</strong></h1>
    }
    else
    {
        <h1 class="titulo_principal_interiores pedido_left">PEDIDO <strong>VALIDADO CON ÉXITO</strong></h1>
    }
    <div class="clear"></div>
    <div style="height: 70px;"></div>
    <div class="caja_pedidos pedidoReservado">

        @Html.Hidden("hdfCorreo", (string)Model.eMail)

        <!-- DIV BARRA -->
        <div id="divBarra" style="display: none;">
            <div id="divBarraMensaje">
                <div id="divBarraMensajeLogrado" style="display:none;">
                    <div style="float:right;">
                        <div class="content_BarrMensaje">
                            <div class="mensaje_barra" style="display: inline;"></div>
                            <div class="agrega_barra"></div>
                        </div>
                        <hr class="clear" />
                        <div class="flechita_barra"></div>
                    </div>
                </div>
            </div>
            <hr class="clear" />
            <div id="divBarraLimite">
            </div>
            <hr class="clear" />
            <div id="divBarraPosicion" class="BarraPosicion">
                @*<span id="divBarraMinimo" class="BarraMinimo"></span>*@
                <span id="divBarraEspacioLimite" class="BarraLimite">
                    <span id="divBarraEspacioLogrado" class="BarraLogrado"></span>
                </span>
            </div>
            <div class="informacion_barra">*Información referencial. Todo pedido realizado a través de la web está sujeto a stock.</div>
        </div>
        <div class="clear"></div>
        <!-- FIN DIV BARRA -->

        <div class="escalaDescuento_texto" style="margin-bottom: 20px; margin-top: 5px;">
            <div class="iconos_acciones">
                <div class="icono_email">
                    <a href="javascript:;" title="Enviar por Correo">
                        <img src="@Url.Content("~/Content/Images/Esika/imprimir.png")" alt="Enviar por correo" onclick="EnviarCorreo();" />
                    </a>
                </div>
            </div>
            <div class="clear"></div>
            <div style="margin-top: 20px; overflow: hidden; margin-bottom: -10px;">
                <div class="titulo_mis_pedidos">
                    @if (ViewBag.ZonaNuevoPROL == true)
                    {
                        <h1>MI <b>PEDIDO RESERVADO CON ÉXITO</b></h1>
                    }
                    else
                    {
                        <h1>MI <b>PEDIDO VALIDADO CON ÉXITO</b></h1>
                    }
                </div>

                <div id="paginadorCab"></div>
                <!--
                <ul class="paginador_notificaciones js-paginador-percepciones" data-paginacion="block" style="margin-top:5px">
                    <li class="seleccion_pagina">
                        <select data-paginacion="rows" style="height: 24px;" data-val="">
                            <option value="10">ver 10 filas</option>
                            <option value="20">ver 20 filas</option>
                            <option value="30">ver 30 filas</option>
                            <option value="40">ver 40 filas</option>
                            <option value="50">ver 50 filas</option>
                        </select>
                    </li>
                    <li class="texto_pagina">Página</li>
                    <li class="flecha_paginador_atras" data-paginacion="back"></li>
                    <li style="margin-right: 6px;">
                        <span class="paginas_pedidos">
                            <span class="pagina_actual">
                                <input type="text" name="paginaactual" data-paginacion="page" value="1" class="ValidaNumeral" id="paginaactual" data-val="1">
                            </span> de
                            <span class="paginas_totales" id="spnPedidoPaginarPaginaDe" data-paginacion="pageCount">2</span>
                        </span>
                    </li>
                    <li class="flecha_paginador_adelante" data-paginacion="next"></li>
                </ul>
                    -->
            </div>
            <hr class="clear" />
        </div>

        <div id="divListadoPedido" class="divListadoPedido">
            <div class="linea_separadora" style="height:2px;"></div>
            <div class="content_listado_notificaciones">
                <div class="cod_venta_listado texto_gris">Código</div>
                <div class="descripcion_listado texto_gris">Producto</div>
                <div class="cantidad_listado texto_gris">Cantidad</div>
                <div class="unitario_listado texto_gris">Precio Unitario</div>
                <div class="total_listado texto_gris">Precio Total</div>
                <div class="cliente_listado texto_gris">Cliente</div>
            </div>
            <div class="linea_separadora"></div>
            <div id="divListado"></div>
        </div>
        <div class="montos_pedidoValidado">
            <div class="monto_totalValidado">MONTO TOTAL: <span>@Model.Simbolo @Model.TotalConDsctoFormato</span></div>
            <div class="info_extra_Validado">
                <img src="@Url.Content("~/Content/Images/Esika/info-copy.png")">
                <!--MONTOS-->
                <div class="monto_resumenValidado">
                    <div class="monto_1">Total sin Dscto.</div>
                    <div class="monto_numero" style="opacity:0.6">@Model.Simbolo  @Model.TotalSinDsctoFormato</div>
                    <hr class="clear" />
                    <div class="monto_1">Dscto. por niveles </div>
                    <div class="monto_numero">@Model.Simbolo @ViewBag.Descuento</div>
                </div>
                <!--FIN-->
            </div>

            <hr class="clear" />
            <div class="monto_gananciaValidado">MI GANANCIA: <span>@Model.Simbolo @ViewBag.GananciaEstimada</span></div>
            <hr class="clear" />
            <div>
                <a class="btn_ModificaPedido" onclick="ModificarPedido();">MODIFICA TU PEDIDO</a>
                <div class="info_modificarvalidado">
                    <span>Puedes realizar cambios hasta el @ViewBag.FechaFacturacionPedido</span>
                </div>
                <hr class="clear" />
            </div>
            <hr class="clear" />
            <div class="linea_gris" style="margin-top:30px"></div>
            @*<div class="eliminar_pedidoValidado">Para eliminar el pedido completo haz <a href="#">click aquí</a></div>
            <div class="eliminar_pedidoValidado" style="float:left">
                <span style="color: #e81c36">(*)</span>    El precio no incluye el descuento de ofertas por niveles.<br />
                Guarda tu pedido y elegiremos la mejor opción para ti.
            </div>*@


        </div>
        
        <div class="contenedor_eliminacion_pedido">
            @if (ViewBag.EsKitNueva == 1)
            {
                <p class="precio_total_sinDescuento">
                    <span class="icon-advertencia"></span>
                    <span>
                        Por ser tu primer pedido estarás recibiendo el Kit de nuevas, el cual será incluido en tu factura.
                    </span>
                </p>
            }
        </div>
        <div class="clear"></div>

        <div class="datos_para_movil">
            @if (ViewBag.Pais_ISO == Constantes.CodigosISOPais.CostaRica)
            {
                <p class="productos_ingresados_movil">
                    <span class="icon-mobile"><img src="@Url.Content("~/Content/Images/mobile-pedido.png")" alt="" /></span><b> Producto ingresado por aplicación "Pedido Belcorp" desde celular.</b>
                </p>
            }
            else if (ViewBag.PedidoProductoMovil == 1)
            {
                <p class="productos_ingresados_movil">
                    <span class="icon-mobile"><img src="@Url.Content("~/Content/Images/mobile-pedido.png")" alt="" /></span><b> Tienes productos pendientes de validación ingresados desde celular, por favor modifique su pedido y valide nuevamente.</b>
                </p>
            }
        </div>

        <div class="contenedor_banners">
            <ul>
                <li>
                    <a href="javascript:;" onclick="MostrarMensaje('Para acceder a esta opción primero debes Modificar tu Pedido.');" title="Productos Descontinuados">
                        <img src="@ViewBag.UrlBanner01" alt="Catálogo Personalizado" />
                        <div>PRODUCTOS DESCONTINUADOS</div>
                    </a>
                </li>

                @if (ViewBag.Pais_ISO == Constantes.CodigosISOPais.Venezuela)
                {
                    <li>
                        <a href="javascript:;" title="Monto Mínimo">
                            <img src="@ViewBag.UrlBanner02" alt="Monto Mínimo" />
                            <div>MONTO MÍNIMO</div>
                        </a>
                    </li>
                }
                else
                {
                    <li>
                        <a href="javascript:void(0);" onclick="MostrarMensaje('Para acceder a esta opción primero debes Modificar tu Pedido.');" title="Liquidaciones Web">
                            <img src="@ViewBag.UrlBanner02" alt="Liquidaciones Web" />
                            <div>LIQUIDACIONES WEB</div>
                        </a>
                    </li>
                }
                <li>
                    <a href="javascript:;" title="Productos Agregados" onclick="MostrarMensaje('Para acceder a esta opción primero debes Modificar tu Pedido.');">
                        <img src="@ViewBag.UrlBanner03" alt="Productos Agotados" />
                        <div>PRODUCTOS AGOTADOS</div>
                    </a>
                </li>
            </ul>
            <div class="clear"></div>
        </div>
    </div>
</div>

<div id="DialogMensajes" style="display: none;">
    <div class="terminos_title_2">
        MENSAJE
    </div>
    <div class="linea_superior margin_10"></div>
    <div class="pop_pedido_mensaje">
    </div>
</div>

<div class="contenedor_popup_productosAgotados" id="divProductoAgotado" style="display: none;">
    <div class="popup_productosAgotados">
        <div class="btn_cerrar_agregarUnidades">
            <a href="javascript:;" onclick="javascript: $('#divProductoAgotado').hide()">
                <img src="@Url.Content("~/Content/Images/btn_cerrar_popup.svg")" alt="Cerrar" />
                <span class="texto_btn_cerrar">CERRAR</span>
            </a>
        </div>
        <div class="contenedor_lista_productosAgotados">
            <h6>PRODUCTOS <b>AGOTADOS</b></h6>
            <div class="tabla_productos_agotados" id="tblProductoSugerido">
                <table></table>
            </div>
        </div>
        <div class="clear"></div>
    </div>
</div>

<div id="divConfirmValidarPROL" style="display: none;">
    <div class="terminos_title_2">
        Importante
    </div>
    <div class="linea_superior margin_10"></div>
    <div class="pop_pedido_mensaje">
        <ul>
            <li>Al hacer click en el botón <b>"Continuar"</b> se perderá la reserva de tus productos. Recuerda, que si lo modificas debes volver a validar.</li>
        </ul>
    </div>
    <div style="text-align: center; margin-top: 30px;">
        <input id="btnValidarConfirm" type="button" value="Cancelar" onclick="CerrarDialogo('divConfirmValidarPROL')" class="input_modifica_horizontal" style="width: 120px; margin-left: 0;" />
        <input id="btnNoValidarConfirm" type="button" value="Continuar" onclick="ConfirmarModificar()" class="input_modifica_horizontal" style="width: 120px; margin-left: 20px;" />
    </div>
</div>

<div id="loadingScreen"></div>

@Html.Hidden("hdfModificacionPedidoProl", Model.ModificacionPedidoProl)


<script id="producto-template" type="text/x-handlebars-template">
    <div class="linea_separadora" style="height:2px;"></div>
    <div class="content_listado_notificaciones">
        <div class="cod_venta_listado texto_gris">Código</div>
        <div class="descripcion_listado texto_gris">Producto</div>
        <div class="cantidad_listado texto_gris">Cantidad</div>
        <div class="unitario_listado texto_gris">Precio Unitario</div>
        <div class="total_listado texto_gris">Precio Total</div>
        <div class="cliente_listado texto_gris">Cliente</div>
    </div>
    <div class="linea_separadora"></div>
    {{#each this}}
    <div class="content_listado_notificaciones">
        <div class="cod_venta_listado">{{CUV}}</div>
        <div class="descripcion_listado">{{DescripcionProd}}</div>
        <div class="cantidad_listado">{{Cantidad}}</div>
        <div class="unitario_listado"> {{PrecioUnidad}}</div>
        <div class="total_listado">{{ImporteTotal}}</div>
        <div class="cliente_listado">{{Nombre}}</div>
    </div>

    {{#IsNullOrEmpty ObservacionPROL '!='}}

    <div class="content_listado_notificaciones">
        <div class="mensaje_producto_validado">{{Split ObservacionPROL '|' 0}}</div>           
    </div>
    {{/IsNullOrEmpty}}

    {{/each}}
</script>

<script id="paginador-template" type="text/x-handlebars-template">
    <ul class="paginador_notificaciones js-paginador-percepciones" data-paginacion="block" style="margin-top:5px">
        <li class="seleccion_pagina">
            <select data-paginacion="rows" style="height: 24px;" data-val="{{RegistrosTotal}}">
                <option value="10">ver 10 filas</option>
                <option value="20">ver 20 filas</option>
                <option value="30">ver 30 filas</option>
                <option value="40">ver 40 filas</option>
                <option value="50">ver 50 filas</option>
            </select>
        </li>
        <li class="texto_pagina">Página</li>
        <li class="flecha_paginador_atras" data-paginacion="back"></li>
        <li style="margin-right: 6px;">
            <span class="paginas_pedidos">
                <span class="pagina_actual">
                    <input type="text" name="paginaactual" data-paginacion="page" value="{{Pagina}}" class="ValidaNumeral" id="paginaactual" data-val="{{Pagina}}">
                </span> de
                <span class="paginas_totales" id="spnPedidoPaginarPaginaDe" data-paginacion="pageCount">{{PaginaDe}}</span>
            </span>
        </li>
        <li class="flecha_paginador_adelante" data-paginacion="next"></li>
    </ul>
</script>

@section scripts{
    <script type="text/javascript">
        var correoElectronico = '@Model.eMail';
        var urlLoad = '@Url.Content("~/Content/Images/Loading.gif")';
    </script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/PortalConsultoras/Pedido/Validado.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/PortalConsultoras/Pedido/barra.js")"></script>
}
