@using Portal.Consultoras.Common
@model Portal.Consultoras.Web.Models.NotificacionesModel
@{
    decimal totalPRol = 0;
    decimal totalPedido = 0;
    decimal descuento = 0;
    //bool IndicadorOferta = false;
    string simboloMoneda = Model.simbolo;
}
@if (Model.Origen != 3)
{
    var isEsika = System.Configuration.ConfigurationManager.AppSettings.Get("PaisesEsika").Contains(ViewBag.PaisIso == null ? "" : ViewBag.PaisIso);
    decimal MontoSinDescuento = Model.ListaNotificacionesDetallePedido.Sum(p => p.ImporteTotal);
    descuento = Model.ListaNotificacionesDetallePedido[0].DescuentoProl;
    totalPedido = (MontoSinDescuento - descuento);

    <div class="wrapper">
        <div class="webkit" style="margin-left:90px">
            <table width="700" align="center" border="0" cellspacing="0" cellpadding="0" style="max-width: 700px;" class="main">
                <tr>
                    <td colspan="2" style="width: 100%; height: 50px; border-bottom: 1px solid #000; padding: 12px 0px; text-align: center; background: #fff">
                        @if (isEsika)
                        {
                            <img src="@Globals.RutaCdn/ImagenesPortal/Iconos/logo.png" alt="Logo Esika" />
                        }
                        else
                        {
                            <img src="@Url.Content("~/Content/Images/Lbel/logo_lbel.png")" alt="Logo Lbel" />
                        }
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="font-family: 'Arial'; font-size: 15px; text-align: center; font-weight: 500; color: #000; padding: 20px 0 10px 0;">
                        Hola @Model.NombreConsultora,
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="text-align: center; font-family: 'Arial'; font-size: 23px; font-weight: 700; color: #000; padding-bottom: 10px; padding-left: 10px; padding-right: 10px;">
                        <span id="sTituloNotificacion">RESERVASTE TU PEDIDO CON ÉXITO</span>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="font-family: 'Arial'; font-size: 13px; text-align: center; font-weight: 500; color: #000; padding: 10px 0 10px"><span id="sMensajePedidoPROL"></span></td>
                </tr>
                @if (Model.ListaNotificacionesDetalle.Count != 0)
                {
                    <tr>
                        <td colspan="2" style="font-family: 'Arial'; font-size: 13px; text-align: left; font-weight: 500; color: #000; padding: 0 50px 10px">
                            <ul style='padding: 0px 0px 0px 15px; margin-top: 0px; text-align: left;'>
                                @foreach (var item in Model.ListaNotificacionesDetalle)
                                {
                                    <li>
                                        @Html.DisplayTextFor(modelItem => item.MensajePROL)
                                    </li>
                                }
                            </ul>

                        </td>
                    </tr>
                    <tr>
                        <td style='padding: 0px 0px 0px 0px; text-align: left; display: block;'>&nbsp;</td>
                    </tr>
                }
                <tr>
                    <td colspan="2" style="text-align: center; font-family: 'Arial'; font-size: 15px; color: #000; padding-bottom: 15px;">
                        Aquí el resumen de tu pedido:
                    </td>
                </tr>
                <tr>
                    <td style="width: 50%; font-family: 'Arial'; font-size: 13px; color: #000; padding-left: 14%; text-align:left;">
                        MONTO TOTAL:
                    </td>
                    <td style="width: 50%; font-family: 'Arial'; font-size: 16px; font-weight: 700; color: #000;padding-right:14%; text-align:right;">
                        @simboloMoneda <span id="sMontoTotal">@string.Format("{0:N2}", totalPedido)</span>
                    </td>
                </tr>
                <tr>
                    <td class="color_marca" style="width: 50%; font-family: 'Arial'; font-size: 13px; font-weight:700; padding-left: 14%; text-align:left; padding-bottom: 20px; padding-top: 5px">
                        GANANCIA ESTIMADA:
                    </td>
                    <td class="color_marca" style="width: 50%; font-family: 'Arial'; font-size: 13px; font-weight: 700; padding-right:14%; text-align:right;padding-bottom: 20px; padding-top: 5px">
                        @simboloMoneda @Model.mGanancia
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="text-align: center; color: #000; font-family: 'Arial'; font-size: 15px; font-weight: 700; border-top:1px solid #000; border-bottom: 1px solid #000; padding-top: 8px; padding-bottom: 8px; letter-spacing: .5px;">
                        DETALLE
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left; color: #000; font-family: 'Arial'; font-size: 13px; font-weight: 700; padding-top: 15px; padding-left: 10px; padding-right: 10px;">DESCRIPCIÓN</td>
                    <td style="text-align: right; color: #000; font-family: 'Arial'; font-size: 13px; font-weight: 700; padding-top: 15px; padding-left: 10px; padding-right: 10px;">SUBTOTAL</td>
                </tr>
                <tr>
                    <td colspan="2" style="padding-top: 15px; padding-left: 10px; padding-right: 10px; border-bottom:2px solid #9E9E9E">
                        @foreach (var item in Model.ListaNotificacionesDetallePedido)
                        {
                            //totalPRol = item.MontoTotalProl;
                            //totalPedido = item.ImporteTotalPedido;

                            <table width="100%" align="center" border="0" cellspacing="0" cellpadding="0" align="center" style="margin-bottom: 20px;">
                                <tr>
                                    <td style="width: 50%; text-align: left; color: #000; font-family: 'Arial'; font-size: 13px; ">Cód. Venta: @item.CUV</td>
                                    <td>&nbsp;</td>
                                </tr>
                                <tr>
                                    <td style="text-align: left; color: #000; font-family: 'Arial'; font-size: 14px; font-weight:700;">@item.Descripcion</td>
                                    <td style="text-align: right; color: #000; font-family: 'Arial'; font-size: 14px; font-weight:700;">
                                        @simboloMoneda @string.Format("{0:N2}", item.ImporteTotal)
                                    </td>
                                </tr>

                                @if (!string.IsNullOrEmpty(@item.ObservacionPROL))
                                {


                                    string[] obser = item.ObservacionPROL.Split('|');


                                    if (obser != null)
                                    {
                                        int total = obser.Length - 1;
                                        int count = 1;
                                        foreach (string ob in obser)
                                        {
                                            if (!string.IsNullOrEmpty(ob))
                                            {
                                                if (total == count)
                                                {
                                                    <tr style="background-color: #eeeeee">
                                                        <td colspan='2' style="text-align: left;color: #000; font-family: 'Arial'; padding:4px 7px 2px">@ob</td>
                                                    </tr>
                                                }
                                                else
                                                {
                                                    <tr style="background-color: #eeeeee;">

                                                        <td colspan='2' style="text-align: left;color: #000; font-family: 'Arial'; padding:4px 7px 2px">@ob</td>
                                                    </tr>
                                                }
                                            }
                                            count++;
                                        }
                                    }

                                }

                                <tr>
                                    <td colspan="2" style="text-align: left; color: #4d4d4e; font-family: 'Arial'; font-size: 13px; padding-top: 2px;">
                                        Cliente: @(!string.IsNullOrEmpty(item.NombreCliente) ? item.NombreCliente : Model.NombreConsultora)
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" style="text-align: left; color: #4d4d4e; font-family: 'Arial'; font-size: 13px; padding-top: 2px;">
                                        Cantidad:@item.Cantidad
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" style="text-align: left; color: #4d4d4e; font-family: 'Arial'; font-size: 13px; padding-top: 2px;">
                                        Precio Unit.: @simboloMoneda @string.Format("{0:N2}", item.PrecioUnidad)
                                    </td>
                                </tr>

                            </table>
                        }
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left; color: #000; font-family: 'Arial'; font-size: 13px; padding-top: 15px; padding-left: 10px;">TOTAL SIN DSCTO.</td>
                    <td style="text-align: right; color: #000; font-family: 'Arial'; font-size: 13px; padding-top: 15px; padding-right: 10px; font-weight: 700;">
                        @simboloMoneda @string.Format("{0:N2}", MontoSinDescuento)
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left; color: #000; font-family: 'Arial'; font-size: 13px; padding-top:3px; padding-left: 10px; border-bottom: 1px solid #000; padding-bottom: 13px;">DSCTO. OFERTAS POR NIVELES</td>
                    <td style="text-align: right; color: #000; font-family: 'Arial'; font-size: 13px; padding-top:3px; padding-right: 10px; font-weight: 700; padding-bottom: 13px; border-bottom: 1px solid #000;">
                        @simboloMoneda @string.Format("{0:N2}", descuento)
                    </td>
                </tr>
                <tr>
                    <td style="width: 50%; font-family: 'Arial'; font-size: 13px; color: #000; padding-left: 10px; text-align:left; padding-top: 15px;">
                        MONTO TOTAL:
                    </td>
                    <td style="width: 50%; font-family: 'Arial'; font-size: 16px; font-weight: 700; color: #000;padding-right:10px; padding-top: 15px; text-align:right;">
                        @simboloMoneda <span id="sMontoTotal2">@string.Format("{0:N2}", totalPedido)</span>
                    </td>
                </tr>
                <tr>
                    <td class="color_marca" style="width: 50%; font-family: 'Arial'; font-size: 13px; font-weight:700; padding-left: 10px; text-align:left; padding-bottom: 13px; padding-top: 5px;">
                        GANANCIA ESTIMADA:
                    </td>
                    <td class="color_marca" style="width: 50%; font-family: 'Arial'; font-size: 13px; font-weight: 700; padding-right:10px; text-align:right; padding-bottom: 13px; padding-top: 5px;">
                        @simboloMoneda @Model.mGanancia
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="font-family: 'Arial'; font-size: 12px; color: #000; padding-top: 25px; padding-bottom: 13px; text-align: center; padding-left: 10px; padding-right: 10px;">

                        IMPORTANTE <BR />
                        <span id="sMensajeFacturacion"></span>
                    </td>
                </tr>
            </table>
        </div>
    </div>
}
else
{
    <div style='font-family: Arial, Helvetica, sans-serif; font-size: 12px; color: #333333; margin: 0; padding: 0; background-color: #F0F0F0;'>
        <table width='100%' border='0' cellpadding='0' cellspacing='0'>
            <tr>
                <td width='100%' style='height: 50px; background: #6C207F;'>&nbsp;</td>
            </tr>
        </table>
        <table width='100%' border='0' cellpadding='0' cellspacing='0' style='padding: 0px; margin: 0px;'>
            <tr>
                <td width='100%' style='text-align: center; background-color: #F0F0F0; overflow: hidden; display: block; padding: 24px 0px 24px 0px;'>
                    <table border='0' cellpadding='0' cellspacing='0' style='width: 675px; margin: 0px auto; text-align: left;'>
                        <tr>
                            <td valign='top'>
                                <table width='675' border='0' cellpadding='0' cellspacing='0'>
                                    <tr>
                                        <td align='left' style='color: #6C207F; font-size: 25px; padding: 0px 0px 10px 0px; text-align: left;'>BELCORP</td>
                                    </tr>
                                    <tr>
                                        <td width='675' valign='top' style='background: #E5E5E5; line-height: 18px; padding: 20px 20px 30px 20px;'>
                                            <table width='100%' border='0' cellpadding='0'>
                                                <tr>
                                                    <td style='padding: 0px 0px 15px 0px; text-align: left; display: block;'>Hola @Model.NombreConsultora</td>
                                                </tr>
                                                <tr>
                                                    <td style='padding: 0px 0px 15px 0px; text-align: left; display: block;'><span>Te informamos lo siguiente: </span></td>
                                                </tr>
                                                @if (Model.ListaNotificacionesDetallePedido.Count != 0)
                                                {
                                                    <tr>
                                                        <td style='padding: 0px 0px 0px 0px; text-align: left;'>
                                                            <ul style='padding: 0px 0px 0px 15px; margin-top: 0px; text-align: left;'>
                                                                @foreach (var item in Model.ListaNotificacionesDetallePedido)
                                                                {
                                                                    <li>
                                                                        @Html.DisplayTextFor(modelItem => item.ObservacionPROL)
                                                                    </li>
                                                                }
                                                            </ul>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td style='padding: 0px 0px 0px 0px; text-align: left; display: block;'>&nbsp;</td>
                                                    </tr>
                                                }
                                                <tr>
                                                    <td style='text-align: left;'>Gracias,</td>
                                                </tr>
                                                <tr>
                                                    <td>Equipo BELCORP.</td>
                                                </tr>
                                            </table>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        <table width='100%' border='0' cellpadding='0' cellspacing='0' style='text-align: center;'>
            <tr>
                <td width='100%' style='height: 50px; background: #FFFFFF;'>
                    <table border='0' cellpadding='0' cellspacing='0' style='width: 675px; margin: 0px auto;'>
                        <tr>
                            <td style='padding: 5px 0px 0px 0px; font-size: 11px; color: #6C207F; text-align: right;'>Copyright Belcorp 2013. All rights reserved</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>
}
 