@using Portal.Consultoras.Common
@model Portal.Consultoras.Web.Models.CDRWebModel

@{
    var formatoFechaCulminado = "--/--/----";
    if (Model.FechaCulminado.HasValue)
    {
        formatoFechaCulminado = Model.FechaCulminado.Value.Day.ToString().PadLeft(2, '0') + "/" +
            Model.FechaCulminado.Value.Month.ToString().PadLeft(2, '0') + "/" + Model.FechaCulminado.Value.Year;
    }

    var formatoCampania = Model.CampaniaID.ToString().Substring(0, 4) + "-" + Model.CampaniaID.ToString().Substring(4, 2);
}

<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" style="background:#FFF;">
    <thead>
        <tr>
            <th colspan="3" style="width: 100%; height: 50px; border-bottom: 1px solid #000; padding: 12px 0px; text-align: center;">
                <img src="http://www.genesis-peru.com/mailing-belcorp/logo.png" alt="Logo Esika" />
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td colspan="3" style="height:30px;"></td>
        </tr>
        <tr>
            <td colspan="3">
                <table align="center" border="0" cellspacing="0" cellpadding="0" style="width:100%; text-align:center; padding-bottom:20px;">
                    <tbody>
                    <tr>
                        <td style="font-family: 'Calibri'; font-size: 17px; text-align: center; font-weight: 500; color: #000; padding: 0 0 20px 0;">
                            ¡Hola @Model.NombreConsultora!
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: center; font-family: 'Calibri'; font-size: 22px; font-weight: 700; color: #000; padding-bottom: 15px;">
                            ESTA ES LA RESPUESTA A TU SOLICITUD DE CAMBIOS Y <br/>DEVOLUCIONES
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: center; font-family: 'Calibri'; color: #000; font-weight: 700; font-size: 14px; padding-bottom: 30px;">
                            En estos momentos la estamos evaluando y en XX horas te daremos una respuesta
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-bottom: 15px;">
                            <table align="center" border="0" cellspacing="0" cellpadding="0" style="width: 100%; padding-left: 14px; padding-right: 14px;">
                                <tbody>
                                <tr>
                                    <td style="width: 33%; text-align: center; font-family: 'Calibri'; font-size: 15px; font-weight: 300; color: black; border-right: 1px solid black; padding-right: 14px;">
                                        Fecha: @formatoFechaCulminado
                                    </td>
                                    <td style="width: 33%; text-align: center; font-family: 'Calibri'; font-size: 15px; font-weight: 300; color: black; border-right: 1px solid black; padding-left: 14px; padding-right: 14px;">
                                        Solicitud: Nº @Model.CDRWebID
                                    </td>
                                    <td style="width: 33%; text-align: center; font-family: 'Calibri'; font-size: 15px; font-weight: 300; color: black; padding-left: 14px;">
                                        Campaña: @formatoCampania
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="3" style="text-align: center; font-family: 'Calibri'; font-weight: 700; color: black; padding-top: 15px; font-size: 15px;">
                                        <span style="font-weight: 300">
                                                    Resumen:
                                                </span>
                                        @Model.ResumenResolucion
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: center; font-size: 17px; font-weight: 700; font-family: 'Calibri'; color: #262626; text-align: center; border-top: 1px solid #979797; border-bottom: 1px solid #979797; padding: 8px;">
                            DETALLE DE LA SOLICITUD
                        </td>
                    </tr>

                        @foreach (var item in Model.ListaDetalle)
                        {
                            var descripcionEstado = item.Estado == Constantes.EstadoCDRWeb.Aceptado
                                ? "APROBADO"
                                : item.Estado == Constantes.EstadoCDRWeb.Enviado
                                    ? "ENVIADO"
                                    : item.Estado == Constantes.EstadoCDRWeb.Observado
                                        ? "RECHAZADO"
                                        : item.Estado == Constantes.EstadoCDRWeb.Pendiente
                                            ? "PENDIENTE"
                                            : "";

                            var descripcionCompleta = item.Estado == Constantes.EstadoCDRWeb.Aceptado
                                ? ""
                                : item.Estado == Constantes.EstadoCDRWeb.Enviado
                                    ? ""
                                    : item.Estado == Constantes.EstadoCDRWeb.Observado
                                        ? item.Observacion
                                        : item.Estado == Constantes.EstadoCDRWeb.Pendiente
                                            ? "Revisa la respuesta en Somos Belcorp."
                                            : "";

                            <tr>
                                <td style="border-bottom: 1px solid #979797; padding-top: 23px; padding-bottom: 15px">
                                    <table align="center" border="0" cellspacing="0" cellpadding="0" style="width: 100%; padding-left: 14px; padding-right: 14px;">
                                        <tbody>
                                        <tr>
                                            <td style="width: 55%; text-align: left; font-family: 'Calibri'; font-size: 16px; color: #e81c36; padding-right: 14px; padding-bottom: 6px; vertical-align: top;">
                                                <span style="font-weight: 700">
                                                        @descripcionEstado:
                                                    </span>
                                                <br/>
                                                @descripcionCompleta
                                                @if (item.Estado == Constantes.EstadoCDRWeb.Pendiente)
                                                {
                                                    <span style="text-decoration: underline; font-weight: 700; color: #e81c36;">
                                                            <a href="#" style="text-decoration: underline; color: #e81c36;">Ir ahora</a>
                                                        </span>
                                                }
                                            </td>
                                            <td style="width: 45%; text-align: left; font-family: 'Calibri'; font-size: 16px; color: black; font-weight: 300; padding-bottom: 6px; vertical-align: top;">
                                                &nbsp;
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="width: 55%; text-align: left; font-family: 'Calibri'; font-size: 16px; color: #000; padding-right: 14px; vertical-align: top;">
                                                @item.CUV
                                            </td>
                                            <td style="width: 45%; text-align: left; font-family: 'Calibri'; font-size: 16px; color: black; font-weight: 300; vertical-align: top;">
                                                Solución solicitada:
                                            </td>
                                        </tr>
                                        @if (item.CodigoOperacion == Constantes.CodigoOperacionCDR.Canje)
                                        {
                                            <tr>
                                                <td style="width: 55%; text-align: left; font-family: 'Calibri'; font-size: 16px; font-weight: 700; vertical-align: top; color: #000; padding-right: 14px;">
                                                    @item.Descripcion
                                                </td>
                                                <td rowspan="2" style="width: 45%; text-align: left; font-family: 'Calibri'; font-size: 16px; vertical-align: top; color: black; font-weight: 700;">
                                                    @item.Solicitud
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width: 55%; text-align: left; font-family: 'Calibri'; font-size: 16px; vertical-align: top; color: black; padding-right: 14px;">
                                                    @item.Cantidad unidades
                                                </td>
                                            </tr>
                                        }
                                        @if (item.CodigoOperacion == Constantes.CodigoOperacionCDR.Devolucion)
                                        {
                                            <tr>
                                                <td style="width: 55%; text-align: left; font-family: 'Calibri'; font-size: 16px; font-weight: 700; vertical-align: top; color: #000; padding-right: 14px;">
                                                    @item.Descripcion
                                                </td>
                                                <td rowspan="2" style="width: 45%; text-align: left; font-family: 'Calibri'; font-size: 16px; vertical-align: top; color: black; font-weight: 700;">
                                                    @item.Solicitud
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width: 55%; text-align: left; font-family: 'Calibri'; font-size: 16px; vertical-align: top; color: black; padding-right: 14px;">
                                                    @item.Cantidad unidades
                                                </td>
                                            </tr>
                                        }
                                        @if (item.CodigoOperacion == Constantes.CodigoOperacionCDR.Faltante)
                                        {
                                            <tr>
                                                <td style="width: 55%; text-align: left; font-family: 'Calibri'; font-size: 16px; font-weight: 700; vertical-align: top; color: #000; padding-right: 14px;">
                                                    @item.Descripcion
                                                </td>
                                                <td rowspan="2" style="width: 45%; text-align: left; font-family: 'Calibri'; font-size: 16px; vertical-align: top; color: black; font-weight: 700;">
                                                    @item.Solicitud
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width: 55%; text-align: left; font-family: 'Calibri'; font-size: 16px; vertical-align: top; color: black; padding-right: 14px;">
                                                    @item.Cantidad unidades
                                                </td>
                                            </tr>
                                        }
                                        @if (item.CodigoOperacion == Constantes.CodigoOperacionCDR.FaltanteAbono)
                                        {
                                            <tr>
                                                <td style="width: 55%; text-align: left; font-family: 'Calibri'; font-size: 16px; font-weight: 700; vertical-align: top; color: #000; padding-right: 14px;">
                                                    @item.Descripcion
                                                </td>
                                                <td rowspan="2" style="width: 45%; text-align: left; font-family: 'Calibri'; font-size: 16px; vertical-align: top; color: black; font-weight: 700;">
                                                    @item.Solicitud
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width: 55%; text-align: left; font-family: 'Calibri'; font-size: 16px; vertical-align: top; color: black; padding-right: 14px;">
                                                    @item.Cantidad unidades
                                                </td>
                                            </tr>
                                        }
                                        @if (item.CodigoOperacion == Constantes.CodigoOperacionCDR.Trueque)
                                        {
                                            <tr>
                                                <td style="width: 55%; text-align: left; font-family: 'Calibri'; font-size: 16px; font-weight: 700; vertical-align: top; color: #000; padding-right: 14px;">
                                                    @item.Descripcion
                                                </td>
                                                <td style="width: 45%; text-align: left; font-family: 'Calibri'; font-size: 16px; vertical-align: top; color: black; font-weight: 700;">
                                                    @item.Solicitud
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width: 55%; text-align: left; font-family: 'Calibri'; font-size: 16px; vertical-align: top; color: black; padding-right: 14px;">
                                                    @item.Cantidad unidades
                                                </td>
                                                <td style="width: 45%; text-align: left; font-family: 'Calibri'; font-size: 16px; vertical-align: top; color: black;">
                                                    @item.CUV2
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width: 55%; text-align: left; font-family: 'Calibri'; font-size: 16px; color: black; padding-right: 14px;">
                                                    Costo: @Model.Simbolo @Util.DecimalToStringFormat(item.Precio, Model.CodigoIso)
                                                </td>
                                                <td style="width: 45%; text-align: left; font-family: 'Calibri'; font-size: 16px; color: black;">
                                                    @item.Descripcion2
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width: 55%; padding-right: 14px;">&nbsp;</td>
                                                <td style="width: 45%; text-align: left; font-family: 'Calibri'; font-size: 16px; vertical-align: top; color: black;">
                                                    @item.Cantidad2 unidades
                                                </td>
                                            </tr>
                                            <tr>
                                                <td style="width: 55%; padding-right: 14px;">&nbsp;</td>
                                                <td style="width: 44%; text-align: left; font-family: 'Calibri'; font-size: 16px; vertical-align: top; color: black;">
                                                    Costo: @Model.Simbolo @Util.DecimalToStringFormat(item.Precio2, Model.CodigoIso)
                                                </td>
                                            </tr>
                                        }
                                        </tbody>
                                    </table>
                                </td>
                            </tr>
                        }
                    <tr>
                        <td style="padding-top: 30px;">
                            <table align="center" border="0" cellspacing="0" cellpadding="0" style="width: 50%; padding-left: 14px; padding-right: 14px; margin-left: 25%; margin-right: 25%;">
                                <tbody>
                                <tr>
                                    <td style="font-weight: 700; color: black; font-size: 14px; width: 100%; border: 2px solid #979797; font-family: 'Calibri'; text-align: center; padding: 10px;">
                                        <a href="#" style="text-decoration: none; font-family: 'Calibri'; font-weight: 700; color: black; font-size: 14px;">
                                            VER LA SOLICITUD EN SOMOS BELCORP
                                        </a>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" style="text-align: center; font-family: 'Calibri'; color: #000; font-size: 12px; font-weight: 400; padding-top: 25px; padding-bottom: 27px;"></td>
                    </tr>
                    <tr>
                        <td colspan="3" style="background: #000; height: 62px;">
                            <table align="center" style="text-align: center; padding: 0 13px; width: 100%; max-width: 550px;">
                                <!--[if gte mso 9]>";
                                    <table id=\"tableForOutlook\"><tr><td>";
                                <![endif]-->
                                <tbody>
                                <tr>
                                    <td style="width: 11%; text-align: left; vertical-align: top;">
                                        <img src="http://www.genesis-peru.com/mailing-belcorp/logo-belcorp.png" alt="Logo Belcorp"/>
                                    </td>
                                    <td style="width: 8%; text-align: left;">
                                        <img src="https://s3.amazonaws.com/uploads.hipchat.com/583104/4019711/G9GQryrWRTreo75/logo-esika.png" alt="Logo Esika"/>
                                    </td>
                                    <td style="width: 8%; text-align: left;">
                                        <img src="https://s3.amazonaws.com/uploads.hipchat.com/583104/4019711/T3o8rSPUKtKpe4g/logo-lbel.png" alt="Logo L'bel"/>
                                    </td>
                                    <td style="width: 15%; text-align: left; border-right: 1px solid #FFF;">
                                        <img src="https://s3.amazonaws.com/uploads.hipchat.com/583104/4019711/qZf6NJ5d9D75LCO/logo-cyzone.png" alt="Logo Cyzone"/>
                                    </td>
                                    <td style="width: 15%; font-family: 'Calibri'; font-weight: 400; font-size: 13px; color: #FFF; vertical-align: middle;">
                                        <table align="center" style="text-align: center; width: 100%;">
                                            <tbody>
                                            <tr>
                                                <td style="text-align: right; font-family: 'Calibri'; font-weight: 400; font-size: 13px; vertical-align: middle; width: 69%; color: white;">SÍGUENOS</td>
                                                <td style="text-align: right; position: relative; top: 2px; left: 10px; width: 20%; vertical-align: top;"><img src="http://www.genesis-peru.com/mailing-belcorp/logo-facebook.png" alt="Logo Facebook"/></td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                                </tbody>
                                <!--[if gte mso 9]>";
                                    </td></tr></table>";
                                <![endif]-->
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3">
                            <table align="center" style="text-align: center; width: 220px;">
                                <tbody>
                                <tr>
                                    <td colspan="2" style="height: 6px;"></td>
                                </tr>
                                <tr>
                                    <td style="text-align: center; width: 49%; border-right: 1px solid #000; padding-right: 13px;">
                                        <span style="font-family: 'Calibri'; font-size: 12px; color: #000;">¿Tienes dudas?</span>
                                    </td>
                                    <td style="text-align: center; width: 49%;">
                                        <span style="font-family: 'Calibri'; font-size: 12px; color: #000;">Contáctanos</span>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </td>
        </tr>
    </tbody>
</table>

