@using Portal.Consultoras.Common
@using Portal.Consultoras.Web.Areas.Mobile.Models
@using Portal.Consultoras.Web.Areas.Mobile.Helpers

@{
    var items = (List<MenuMobileModel>)ViewBag.MenuMobile;
    var itemsMenu = items == null ? new List<MenuMobileModel>() : items.Where(p => p.Posicion.ToLower().Equals("menu")).ToList();
    var urlDomain = Util.GetUrlHost(Request);
    var tipoUsuaio = ViewBag.TipoUsuario;
}

<div class="botones">
    <a role="menu" region="Menú Lateral" parent="Ingresa tu Pedido" title="Ingresa tu Pedido"
       class="menu_mobile_belcorp indicador_bel" href="@Url.Action("Index", "Pedido", new {area = "Mobile"})" id="lnk-lat-ingresa-tu-pedido">INGRESA<b>TU PEDIDO</b></a>

@foreach (var item in itemsMenu)
{
    if (item.SubMenu.Count == 0)
    {
        if (item.Descripcion.Trim() == "VENTA EXCLUSIVA WEB")
        {
            if (Session["EsShowRoom"] != null && Session["EsShowRoom"].ToString() == "1")
            {
                if (Session["MostrarShowRoomProductos"] != null && Session["MostrarShowRoomProductos"].ToString() == "1")
                {
                    <a role="menu" region="Menú Lateral" parent=@item.Descripcion.Trim() title=@item.Descripcion.Trim()
                           class="menu_mobile_belcorp etiqueta_showroom wsventa" href="@Url.Action("Index", "ShowRoom", new { area = "Mobile" })" id="lnk-lat-ingresa-tu-pedido"><b>@item.Descripcion.Trim() </b></a>
                }
                else
                {
                    <a role="menu" region="Menú Lateral" parent=@item.Descripcion.Trim() title=@item.Descripcion.Trim()
                           class="menu_mobile_belcorp etiqueta_showroom wsintriga" href="@Url.Action("Intriga", "ShowRoom", new { area = "Mobile" })" id="lnk-lat-ingresa-tu-pedido"><b>@item.Descripcion.Trim() </b></a>
                }
            }
        }
        else
    if (item.Descripcion.Trim() == "¿Necesitas ayuda?")
    {
        var target = item.PaginaNueva ? "_blank" : "_self";
        var url = item.Version == "Completa"
            ? item.UrlItem.StartsWith("http") ? item.UrlItem : string.Format("{0}Mobile/Menu/Ver?url={1}", urlDomain, item.UrlItem)
            : item.UrlItem.StartsWith("http") ? item.UrlItem : string.Format("{0}{1}", urlDomain, item.UrlItem);
        var onclickF = "";
                 <a role="menu" region="Menú Lateral" parent="@item.MenuPadreDescripcion" title="@item.Descripcion"
                   class="etiqueta_chat menu_mobile_belcorp" href="@url" @onclickF id="lnk-prin-@item.Descripcion.GenerateLinkForGoogleTagManager()" target="@target">
                    @item.Descripcion
                </a>
    
    }
    else if (item.SubMenu.Count == 0)
        {
            var target = item.PaginaNueva ? "_blank" : "_self";
            var url = item.Version == "Completa"
                ? item.UrlItem.StartsWith("http") ? item.UrlItem : string.Format("{0}Mobile/Menu/Ver?url={1}", urlDomain, item.UrlItem)
                : item.UrlItem.StartsWith("http") ? item.UrlItem : string.Format("{0}{1}", urlDomain, item.UrlItem);
            url = tipoUsuaio == 2 && item.Descripcion.ToLower().Trim() == "mi academia" ? "javascript:;" : url;
            var onclickF = tipoUsuaio == 2 && item.Descripcion.ToLower().Trim() == "mi academia" ? "onclick='return messageInfoPostulante();'" : "";

            <a role="menu" region="Menú Lateral" parent="@item.MenuPadreDescripcion" title="@item.Descripcion"
               class="menu_mobile_belcorp" href="@url" @onclickF id="lnk-prin-@item.Descripcion.GenerateLinkForGoogleTagManager()" target="@target">
                @if (item.UrlImagen != "")
                {
                    <img src="@item.UrlImagen" alt="@item.Descripcion" />
                }
                else
                {
                    @item.Descripcion
                }
            </a>
        }
    }

    else
    {
        <a role="menu" region="Menú Lateral" parent="@item.Descripcion" title="@item.Descripcion"
           class="menu_mobile_belcorp indicador_submenu" data-toggle="collapse" data-parent="#accordion" href="#SubMenu_@item.Descripcion.GenerateLinkForGoogleTagManager()">@item.Descripcion</a>
            <div class="panel-collapse collapse submenu_1" id="SubMenu_@item.Descripcion.GenerateLinkForGoogleTagManager()">
                @foreach (var subItem in item.SubMenu)
                {
                    var target = subItem.PaginaNueva ? "_blank" : "_self";
                    var url = subItem.Version == "Completa"
                        ? subItem.UrlItem.StartsWith("http") ? subItem.UrlItem : string.Format("{0}Mobile/Menu/Ver?url={1}", urlDomain, subItem.UrlItem)
                        : subItem.UrlItem.StartsWith("http") ? subItem.UrlItem : string.Format("{0}{1}", urlDomain, subItem.UrlItem);

                    if (tipoUsuaio == 2 && subItem.Descripcion.ToLower().Trim() == "app de catálogos")
                    {
                        <a role="menu" region="Menú Lateral" parent="@subItem.MenuPadreDescripcion" title="@subItem.Descripcion"
                           class="menu_subHeader" href="#" onclick="return messageInfoPostulante();">
                            @subItem.Descripcion
                            <div class="notificaciones_menu_mobile2">¡Afiliate!</div>
                        </a>
                    }
                    else
                    {
                        <a role="menu" region="Menú Lateral" parent="@subItem.MenuPadreDescripcion" title="@subItem.Descripcion"
                           class="menu_subHeader" href="@url" id="lnk-prin-@subItem.Descripcion.GenerateLinkForGoogleTagManager()" target="@target">
                            @subItem.Descripcion
                        @if (ViewBag.TipoMenuConsultoraOnline == 1)
                        {
                            if (subItem.MenuMobileID == ViewBag.MenuHijoIDConsultoraOnline)
                            {
                                <div class="notificaciones_menu_mobile2">¡Afiliate!</div>
                            }
                        }
                        else if (ViewBag.TipoMenuConsultoraOnline == 2)
                        {
                            if (subItem.MenuPadreID == ViewBag.MenuPadreIDConsultoraOnline && subItem.Descripcion.ToLower().Trim() == "pedidos pendientes")
                            {
                                if (ViewBag.CantPedidosPendientes > 0)
                                {
                                    <div class="notificaciones_menu_mobile">@ViewBag.CantPedidosPendientes</div>
                                }
                            }
                        }
                    </a>
                    }
                }
            </div>
        }
    }
</div>
