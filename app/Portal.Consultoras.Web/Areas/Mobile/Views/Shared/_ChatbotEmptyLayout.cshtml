@using Portal.Consultoras.Common
@using Portal.Consultoras.Web.CustomHelpers
<!DOCTYPE html>
<html lang="es-PE">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="SomosBelcorp Web Mobile" />
    <title>Somos Belcorp</title>

    @Html.Partial("~/Views/Shared/VistaParcialMainLayout/_vpTagManagerHeader.cshtml", new ViewDataDictionary { { "TipoLayoutTagManager", 1 } })
    @*@Html.Partial("~/Views/Shared/VistaParcialMainLayout/_GoogleOptimize.cshtml")*@
    @Html.Partial("~/Views/Shared/VistaParcialMainLayout/_vpTagManager.cshtml")

    <link href='https://fonts.googleapis.com/css?family=Lato:400,100,300,700,900' rel='stylesheet' type='text/css'>
    @if (System.Configuration.ConfigurationManager.AppSettings.Get("PaisesEsika").Contains(ViewBag.PaisAnalytics))
    {
        <link href="@Url.Content("~/Content/Images/Esika/favicon.ico")" rel="shortcut icon" type="image/x-icon" />
        @Styles.Render("~/Bundle/Css/Mobile/esika-CssSB2Mobile")
    }
    else
    {
        <link href="@Url.Content("~/Content/Images/Lbel/favicon.ico")" rel="shortcut icon" type="image/x-icon" />
        @Styles.Render("~/Bundle/Css/Mobile/lbel-CssSB2Mobile")
    }
    <link href="@Url.Content("~/Content/Css/Mobile/calc.css")" rel="stylesheet" type="text/css" />

    @Html.Partial("~/Views/Shared/VistaParcialMainLayout/_vpVariablesGeneralesPortal.cshtml")
    <script type="text/javascript">
        var isEsika = '@(System.Configuration.ConfigurationManager.AppSettings.Get("PaisesEsika").Contains(ViewBag.PaisAnalytics))' == "True";
    </script>
    @RenderSection("styles", required: false)

    @if (TempData.ContainsKey("PixelCodigoIso"))
    {
        <noscript id="noscript-pixel-image"></noscript>
    }
</head>
<body>
    @Html.Partial("~/Views/Shared/VistaParcialMainLayout/_vpTagManagerBody.cshtml")

    <input type="hidden" id="hdCampaniaCodigo" value="@ViewBag.CampaniaCodigo" />
    <section style="min-height: 380px;">
        <div id="content" data-content="" style="margin-top: 0;">
            @RenderBody()
        </div>
        <div class="clear">
            <br />
            <br />
        </div>
    </section>

    @Html.Partial("~/Areas/Mobile/Views/Shared/VistaParcialMobileLayout/_vpLoadingMobile.cshtml")

    @Scripts.Render("~/Bundle/Js/Mobile/MobileLayout")
    <script type="text/javascript">
        var baseUrl = "@Url.Content("~")";
        var formatDecimalPaisMain = '@ViewBag.FormatDecimalPais';
        var ViewBagEsMobile = '@ViewBag.EsMobile';
        var urlChatbot = '@System.Configuration.ConfigurationManager.AppSettings.Get("UrlChatbot")';
        var ingresoExterno = '@ViewContext.GetUniqueSession("IngresoExterno")';
        var gTipoUsuario = '@ViewBag.TipoUsuario';
    </script>
    <script type="text/javascript">
        $(function () {
            SetFormatDecimalPais(formatDecimalPaisMain);

            HandlebarsRegisterHelper();

            if (ingresoExterno == "NoSoporta") {
                $("body").on("click", ".enlace_regresar", function (e) {
                    window.location.href = urlChatbot;
                });
            } else if (ingresoExterno == "Soporta") {
                $(".enlace_regresar").hide();
            }

            $("body").on("keyup", ".ValidaNumeral", function (evt) {
                var theEvent = evt || window.event;
                var key = theEvent.keyCode || theEvent.which;
                key = String.fromCharCode(key);
                var regex = /[0-9]|\./;
                if (!regex.test(key)) {
                    theEvent.returnValue = false;
                    if (theEvent.preventDefault) theEvent.preventDefault();
                }
            });

            $("body").on("keypress", ".ValidaNumeral", function (e) {
                if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
                    return false;
                }
            });

            $("body").on('paste', ".ValidaPasteNumeral", function (e) {
                var $input = $(this);
                var previousVal = $input.val();
                var pastedValue = e.originalEvent.clipboardData.getData('text/plain').trim();
                if (isNaN(pastedValue) === false && isInt(Number(pastedValue))) {
                    $input.val(pastedValue);
                    e.preventDefault();
                } else {
                    $input.val(previousVal);
                    e.preventDefault();
                };
            });

            $("body").on("click", "[data-popup-main]", function (e) {
                if (!$(e.target).closest('[data-popup-body]').length) {

                    if ($(e.target).is(':visible')) {

                        var functionHide = $.trim($('[data-popup-main]').attr("data-popup-function-hide"));
                        FuncionEjecutar(functionHide);
                        $(e.target).hide();
                        $('body').css({ 'overflow-y': 'scroll' });
                    }
                }
            });

            $("body").on("click", "[data-popup-close]", function (e) {
                var popupClose = $("#" + $(this).attr("data-popup-close")) || $(this).parent("[data-popup-main]");

                var functionHide = $.trim($(popupClose).attr("data-popup-function-hide"));
                FuncionEjecutar(functionHide);
                $(popupClose).hide();
                $('body').css({ 'overflow-y': 'scroll' });
            });
        });

        function ShowLoading() {
            $("#loading-spin").fadeIn();
        }

        function CloseLoading() {
            $("#loading-spin").fadeOut("fast");
        }

        function messageInfo(message, fnAceptar) {
            message = $.trim(message);
            if (message == "") {
                return false;
            }

            $('#mensajeInformacion').html(message);
            $('#popupInformacion').show();
            if ($.isFunction(fnAceptar)) {
                $('#popupInformacion .btn-aceptar').off('click');
                $('#popupInformacion .btn-aceptar').on('click', fnAceptar);
            }
        }

        function messageInfoBueno(message, fnAceptar) {
            $('#mensajeInformacionSB2Bueno').html(message);
            $('#popupInformacionSB2Bueno').show();
            if ($.isFunction(fnAceptar)) {
                $('#popupInformacionSB2Bueno .btn_ok_mobile').off('click');
                $('#popupInformacionSB2Bueno .btn_ok_mobile').on('click', fnAceptar);
            }
        }

        function messageInfoMalo(message, fnAceptar) {
            $('#mensajeInformacionSB2_Malo').html(message);
            $('#popupInformacionSB2Malo').show();
            if ($.isFunction(fnAceptar)) {
                $('#popupInformacionSB2Malo .btn-aceptar').off('click');
                $('#popupInformacionSB2Malo .btn-aceptar').on('click', fnAceptar);
            }
        }

        function messageInfoError(message, fnAceptar) {
            $('#mensajeInformacionSB2_Error').html(message);
            $('#popupInformacionSB2Error').show();
            if ($.isFunction(fnAceptar)) {
                $('#popupInformacionSB2Error .btn-aceptar').off('click');
                $('#popupInformacionSB2Error .btn-aceptar').on('click', fnAceptar);
            }
        }

        function messageInfoValidado(message, fnAceptar) {
            $('#mensajeInformacionvalidado').html(message);
            $('#popupInformacionValidado').show();
            if ($.isFunction(fnAceptar)) {
                $('#popupInformacionValidado .btn_ok_mobile').off('click');
                $('#popupInformacionValidado .btn_ok_mobile').on('click', fnAceptar);
            }
        }

        function SeparadorMiles(pnumero) {
            // Función que colocará el caracter "." como separador de miles.

            var resultado = "";
            var numero = pnumero.replace(/\,/g, '');
            var nuevoNumero = "";
            if (numero[0] == "-") nuevoNumero = numero.replace(/\./g, '').substring(1);
            else nuevoNumero = numero.replace(/\./g, '');

            if (numero.indexOf(",") >= 0) nuevoNumero = nuevoNumero.substring(0, nuevoNumero.indexOf(","));

            for (var j, i = nuevoNumero.length - 1, j = 0; i >= 0; i-- , j++)
                resultado = nuevoNumero.charAt(i) + ((j > 0) && (j % 3 == 0) ? "." : "") + resultado;

            if (numero.indexOf(",") >= 0) resultado += numero.substring(numero.indexOf(","));

            if (numero[0] == "-") return "-" + resultado;
            else return resultado;
        }
    </script>
    <script type="text/javascript">
        var baseUrl = "@Url.Content("~")";
        var isEsika = '@(System.Configuration.ConfigurationManager.AppSettings.Get("PaisesEsika").Contains(ViewBag.PaisAnalytics == null ? "" : ViewBag.PaisAnalytics))' == "True";
        var trackingJetloreAccessToken = '@System.Configuration.ConfigurationManager.AppSettings.Get("TrackingJetloreAccessToken")';
        var tipoOfertaFinalCatalogoPersonalizado = '@Constantes.TipoOfertaFinalCatalogoPersonalizado.Jetlore';
        var esPaisTrackingJetlore = '@ViewBag.PaisesConTrackingJetlore';

        var gTipoUsuario = '@ViewBag.TipoUsuario';
        var IsoPais = '@ViewBag.CodigoISODL';

        //Postulante
        var mostrarBannerPostulante = '@ViewBag.MostrarBannerPostulante';

        //GPR
        var estaRechazado = '@ViewBag.IndicadorGPRSB';
        var cerrarRechazado = '@ViewBag.CerrarRechazado';
        var mostrarBannerRechazo = '@ViewBag.MostrarBannerRechazo';

        //ODD
        var MostrarODD = '@ViewBag.MostrarODD';
        var tieneOfertaDelDia = '@ViewBag.TieneOfertaDelDia';
        var mostrarBannerSuperiorOdd = '@ViewBag.MostrarBannerSuperiorOdd';

        var FechaActual = '@(DateTime.Now.ToString("dd/MM/yyyy"))';

        window.urlLogDynamo = '@System.Configuration.ConfigurationManager.AppSettings["UrlLogDynamo"]';
        window.urlLogElastic = '@System.Configuration.ConfigurationManager.AppSettings["UrlLogElastic"]';
        window.patternElastic = '@System.Configuration.ConfigurationManager.AppSettings["PatternElastic"]';

        // Seteando Controlador y Accion
        @{
            var routeValues = HttpContext.Current.Request.RequestContext.RouteData.Values;
            string ctrl = routeValues.ContainsKey("controller") ? routeValues["controller"].ToString() : "CtrlNoRoute";
            string acti = routeValues.ContainsKey("action") ? routeValues["action"].ToString() : "ActiNoRoute";
        }
        window.controllerName = '@ctrl.ToLower()';
        window.actionName     = '@acti.ToLower()';

        var userData = {
            'aplicacion': '@(Constantes.LogDynamoDB.AplicacionPortalConsultoras)',
            'rol': '@(Constantes.LogDynamoDB.RolConsultora)',
            'campana': '@ViewBag.CampaniaCodigo',
            'region': '@ViewBag.RegionAnalytics',
            'zona': '@ViewBag.ZonaAnalytics',
            'seccion': '@ViewBag.SeccionAnalytics',
            'pais': '@ViewBag.PaisAnalytics',
            'codigoConsultora': '@ViewBag.CodigoConsultoraDL'
        };
        var usuarioNombre = '@ViewBag.UsuarioNombre';
        var OrigenDesktopODD = 0;
    </script>
    @RenderSection("scripts", required: false)

    @System.Web.Optimization.Scripts.Render("~/Bundle/Js/Mixto/Login-Header")
    <script>
        var pixelAnalytics = Analytics({ pixelId : '@Constantes.Facebook.FB_Pixel'});

            @if (TempData.ContainsKey("PixelCodigoIso"))
            {
                @:pixelAnalytics.invocarEventoPixelById('@(TempData["PixelMarcacion"])', '@(TempData["PixelId"])');
                @TempData.Remove("PixelCodigoIso");
            }
        pixelAnalytics.invocarPageViewPixelById();
    </script>

    <script type="text/javascript" id="lightning_bolt" src="//cdn-akamai.mookie1.com/LB/LightningBolt.js"></script>

</body>
</html>