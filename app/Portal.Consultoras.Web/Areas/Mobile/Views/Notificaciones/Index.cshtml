@using Portal.Consultoras.Common;
@using Portal.Consultoras.Web.CustomHelpers
@using Portal.Consultoras.Web.Models
@model NotificacionesModel
@{
    if (Model.Origen == int.Parse(Constantes.IngresoExternoOrigen.ChatBot))
    {
        Layout = "~/Areas/Mobile/Views/Shared/_ChatboMobileLayout.cshtml";
    }
    else
    {
        Layout = "~/Areas/Mobile/Views/Shared/_MobileLayout.cshtml";
    }

}

@section styles{
    <style type="text/css">
        body {
            background: #FFF !important;
        }

        .no_leido {
            content: "";
            position: absolute;
            top: 5px;
            bottom: 5px;
            margin-bottom: 10px;
            font-weight: bold;
        }
    </style>
}

@if (Model.Origen == int.Parse(Constantes.IngresoExternoOrigen.ChatBot))
{
    <div class="titulo_mobile">MIS NOTIFICACIONES</div>
}
else
{
    <div class="titulo_mobile">
    @{
        var mobileConfiguracion = Html.MobileAppConfiguracion();
        if (mobileConfiguracion.MostrarBotonAtras)
        {
            <a href="@Request.UrlReferrer" class="enlace_regresar catalogosR" title="Regresar"></a>
        }
    }
    &nbsp;&nbsp;&nbsp;&nbsp;MIS NOTIFICACIONES
</div>
}
<div class="pestana_esika"></div>
<div class="pestana_lbel"></div>
@if (Model.ListaNotificaciones.Count == 0)
{

    <div class="col-xs-12">
        <div class="icono_alerta exclamacion_icono_mobile"></div>
        <div class="mensaje_alerta">No existe notificaciones para mostrar.</div>

    </div>

}
else
{
    <div class="col-xs-12" style="background:#fff !important;">
        <ul class="list-notificaciones">
            @foreach (var item in Model.ListaNotificaciones)
            {
                var estilo = item.Visualizado ? "" : "no_leido";

                <li class="@estilo" onclick="VisualizarPopup('@item.ProcesoId','@item.Observaciones','@item.Estado','@item.FacturaHoy.ToString()','@item.FechaFacturacion.Day','@item.FechaFacturacion.Month','@item.Visualizado.ToString()','@item.Asunto','@item.Proceso', this, '@item.CampaniaId')">

                    <div class="text-noti">
                        <div  >

                            @if (item.FlagProcedencia == true)
                            {
                                <span id="lnk-cue-notificacion-@item.ProcesoId" role="link" title="Tienes una nueva notificación">@item.Asunto</span>
                            }
                            else
                            {
                                <span id="lnk-cue-notificacion" role="link" title="Tienes una nueva notificación">@item.Asunto</span>
                            }



                            
                            @if (item.CampaniaId > 0)
                            {
                                @("C" +item.CampaniaId.ToString().Substring(4) + " " + item.CampaniaId.ToString().Substring(0, 4))
                            }

                        </div>
                        <span class="fecha_notificaciones">
                            @Html.DisplayTextFor(modelItem => item.FechaHoraValidación)
                        </span>
                    </div>

                </li>
            }
        </ul>
    </div>
}


@section scripts{
    <script>
        var urlActualizarEstadoNotificacion = '@Url.Action("ActualizarEstadoNotificacion", "Notificaciones", new { area = "" })';
        var urlDetallePedidoRechazado = '@Url.Action("DetallePedidoRechazado", "Notificaciones", new { area = "Mobile" })';
        var urlDetalleSolicitudClienteCatalogo = '@Url.Action("DetalleSolicitudClienteCatalogo", "Notificaciones", new { area = "Mobile" })';
        var urlConsultoraOnlinePendientes = '@Url.Action("Pendientes", "ConsultoraOnline", new { Area = "Mobile" })';
        var urlConsultoraOnlineHistorial = '@Url.Action("Historial", "ConsultoraOnline", new { Area = "Mobile" })';
        var urlListarObservacionesStock = '@Url.Action("ListarObservacionesStock", "Notificaciones", new { area = "Mobile" })';
        var urlListarObservaciones = '@Url.Action("ListarObservaciones", "Notificaciones", new { area = "Mobile" })';
        var urlListarDetalleCDR = '@Url.Action("DetalleCDR", "Notificaciones", new { area = "Mobile"})';
        var urlListarDetalleCDRCulminado = '@Url.Action("DetalleNotificacionesCDR", "Notificaciones", new { area = "Mobile" })';
        var urlListarPayOnline = '@Url.Action("DetallePagoEnLinea", "Notificaciones", new { area = "Mobile" })';
        localStorage.setItem('KeyPseudoParam', new Date().getTime()); //SALUD-58
    </script>
    <script src="@Url.Content("~/Scripts/PortalConsultoras/Mobile/Notificaciones/Index.js")"></script>
}
