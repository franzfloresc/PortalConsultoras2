@using Portal.Consultoras.Web.Models
@model NotificacionesModel

@{
    Layout = "~/Areas/Mobile/Views/Shared/_MobileLayout.cshtml";
}

@section styles{
    <style type="text/css">
        body {
            background: #FFF !important;
        }

        .no_leido {
            content: "";
            position: absolute;
            top: 5px;
            bottom: 5px;
            /* left: -15px; */
            /* border-left: 7px solid #000; */
            margin-bottom: 10px;
            font-weight: bold;
        }
    </style>
}
<div class="titulo_mobile">
    <a href="@Request.UrlReferrer" class="enlace_regresar catalogosR" title="Regresar"></a>
    &nbsp;&nbsp;&nbsp;&nbsp;MIS NOTIFICACIONES
</div>
<div class="pestana_esika"></div><!--PESTANA ESIKA-->
<div class="pestana_lbel"></div><!--PESTANA LBEL-->
@if (Model.ListaNotificaciones.Count == 0)
{
    
        <div class="col-xs-12">
            <div class="icono_alerta exclamacion_icono_mobile"></div>
            <div class="mensaje_alerta">No existe notificaciones para mostrar.</div>
            
        </div>
   
}
else
{
    <div class="col-xs-12" style="background:#fff !important;">
        <ul class="list-notificaciones">
            @foreach (var item in Model.ListaNotificaciones)
            {
                var estilo = item.Visualizado ? "" : "no_leido";

                <li class="@estilo" onclick="VisualizarPopup('@item.ProcesoId','@item.Observaciones','@item.Estado','@item.FacturaHoy.ToString()','@item.FechaFacturacion.Day','@item.FechaFacturacion.Month','@item.Visualizado.ToString()','@item.Asunto','@item.Proceso')">

                    <div class="text-noti">
                        <div class="upper">
                            
                                @if (item.FlagProcedencia == true)
                                {
                                    <span id="lnk-cue-notificacion-@item.ProcesoId" role="link" title="Tienes una nueva notificación">@item.Asunto</span>
                                }
                                else
                                {
                                    <span id="lnk-cue-notificacion" role="link" title="Tienes una nueva notificación">@item.Asunto</span>
                                }
                            

                            
                                CAMPAÑA
                                @if (item.CampaniaId > 0)
                                {
                                    @(item.CampaniaId.ToString().Substring(4) + " " + item.CampaniaId.ToString().Substring(0, 4))
                                }
                            
                        </div>
                        <span class="fecha_notificaciones">
                            @Html.DisplayTextFor(modelItem => item.FechaHoraValidación)
                        </span>
                    </div>

                </li>
            }
        </ul>
    </div>
}


@section scripts{
    <script>
        var urlConsultoraOnlinePendientes = '@Url.Action("Pendientes", "ConsultoraOnline", new { Area = "Mobile" })';
        var urlConsultoraOnlineHistorial = '@Url.Action("Historial", "ConsultoraOnline", new { Area = "Mobile" })';
        function VisualizarPopup(ProcesoId, Observaciones, Estado, FacturaHoy, DiaFact, MesFact, Visualizado, Asunto, Proceso) {
            ShowLoading();

            var TipoOrigen;
            switch (Proceso) {
                case "VALAUTO": TipoOrigen = 1; break;
                case "VALMOVIL": TipoOrigen = 2; break;
                case "BUSCACONS": TipoOrigen = 4; break;
                case "CATALOGO": TipoOrigen = 5; break;
                case "PEDREC": TipoOrigen = 6; break;
                default: TipoOrigen = 3; break;
            }

            if (TipoOrigen == 6) location.href = '@Url.Action("DetallePedidoRechazado", "Notificaciones", new { area = "Mobile" })' + "?ProcesoId=" + ProcesoId;
            else if (TipoOrigen == 5) location.href = '@Url.Action("DetalleSolicitudClienteCatalogo", "Notificaciones", new { area = "Mobile" })' + "?SolicitudId=" + ProcesoId;
            else if (TipoOrigen == 4) {
                location.href = '@Url.Action("DetallePedido", "ConsultoraOnline", new { area = "Mobile" })' + "?pedidoId=" + ProcesoId; //GR-723
                //location.href = '@Url.Action("DetalleSolicitudCliente", "Notificaciones", new { area = "Mobile" })' + "?SolicitudId=" + ProcesoId;
            } 
            else if (TipoOrigen != 3) location.href = '@Url.Action("ListarObservaciones", "Notificaciones", new { area = "Mobile" })' + "?ProcesoId=" + ProcesoId + "&TipoOrigen=" + TipoOrigen;
            else location.href = '@Url.Action("ListarObservacionesStock", "Notificaciones", new { area = "Mobile" })' + "?ValStockId=" + Observaciones;
        }
</script>
    <script src="@Url.Content("~/Scripts/PortalConsultoras/Mobile/Notificaciones/Index.js")"></script>
}
