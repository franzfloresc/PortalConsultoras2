@using Portal.Consultoras.Common
@using Portal.Consultoras.Web.Areas.Mobile.Models

@model PedidoDetalleMobileModel

@{
    Layout = "~/Areas/Mobile/Views/Shared/_MobileLayout.cshtml";
}

<link href="@Url.Content("~/Content/Css/Site/slick-pedido.css")" rel="stylesheet" />

<!--SB20-565 - INICIO -->
<input type="hidden" id="hdEsFacturacion" value="@Model.EsFacturacion.ToString()" />
<input type="hidden" id="hdOfertaFinal" value="@Model.OfertaFinal" />
<input type="hidden" id="hdEsOfertaFinalZonaValida" value="@Model.EsOfertaFinalZonaValida.ToString()" />
<input type="hidden" id="hdListaParametriaOfertaFinal" value="@Newtonsoft.Json.JsonConvert.SerializeObject(Model.ListaParametriaOfertaFinal)" />
<input type="hidden" id="hdEsConsultoraNueva" value="@Model.EsConsultoraNueva.ToString()" />
<input type="hidden" id="hdListaEscala" value="@Newtonsoft.Json.JsonConvert.SerializeObject(Model.DataBarra.ListaEscalaDescuento)" />
<input type="hidden" id="hdMontoMinimo" value="@Model.MontoMinimo" />
<!--SB20-565 - FIN -->

<div class="contenedor_producto">
    <div class="content_320 ingresoPedidom">
        <input id="hdAccionBotonProl" type="hidden" value="@ViewBag.AccionBoton" />
        <div class="contenedor_detalle_pedidoIngresado">
            <div class="contenedor_resumenPedido">
                <a href="@Request.UrlReferrer" class="enlace_regresar detalleP" title="Regresar"></a>
                <h2 class="nombre_campania_pedido">
                    MI PEDIDO
                    <span>@Model.DescripcionCampaniaActual</span>
                </h2>

                <div id="divProductosDetalle">
                    <div class="text-center">
                        <img alt="Cargando..." src="@Url.Content("~/Content/images/Loading.gif")" />
                    </div>
                </div>
            </div>
        </div>

        @{
            string[] tooltips = Model.ProlTooltip.Split('|');
            string tooltip1 = tooltips[0];
            string tooltip2 = tooltips[1];
        }
        <div class="tooltip_noOlvidesGuardarTuPedido" style="display: none;">
            @*<h2>¡Es importante que guardes tu pedido!</h2>*@
            @*<span>Puedes realizar cambios hasta el @Model.FechaFacturacionPedido</span>*@

            <h2>@tooltip1</h2>
            <span>@tooltip2</span>
        </div>

    </div>
</div>

<div class="btn_guardarPedido">
    <input type="submit" value="@Model.Prol" id="btnGuardarPedido" name="btnGuardarPedido" onclick="EjecutarPROL();" />
</div>

<!-- START Popup para Observaciones PROL -->
<div class="MensajeAlertaMobile" id="popup-observaciones-prol" style="display:none;">
    <div class="content_mensajeAlerta">
        <a class="cerrar_popMobile" href="javascript:;" onclick="$('#popup-observaciones-prol').hide();">
            <img src="/Content/Images/mobile/Esika/cerrar_04.png" alt="-">
        </a>
        <hr class="clear">
        <div id="iconoPopupMobile" class="icono_alerta exclamacion_icono_mobile"></div>
        <div class="titulo_compartir"><b>IMPORTANTE</b></div>
        <div class="mensaje_alerta" id="modal-prol-contenido"></div>
        <div id="modal-prol-botonesAceptarCancelar" style="display: none;">
            <a href="javascript:;" onclick="AceptarObsInformativas();" class="btn_ok_mobile"><b>OK</b></a>
            <a href="javascript:;" onclick="CancelarObsInformativas();" class="btn_ok_mobile"><b>CANCELAR</b></a>
        </div>
        <div id="modal-prol-botoneAceptar">
            <a href="javascript:;" onclick="$('#popup-observaciones-prol').hide();" id="" class="btn_ok_mobile"><b>OK</b></a>
        </div>
    </div>
</div>
<!-- END Popup para Observaciones PROL -->
<!-- START POPUP PERSONALIZADO 2 SEGUNDOS SE OCULTA -->
<div id="popup-eliminar-mensaje" class="MensajeAlertaMobile" style="display:none;">
    <div class="content_mensajeAlerta">
        <a class="cerrar_popMobile" href="javascript:;" onclick="javascript: $('#popup-eliminar-item').hide();">
            <img src="/Content/Images/mobile/Esika/cerrar_04.png" alt="-">
        </a>
        <hr class="clear">
        <div class="icono_alerta exclamacion_icono_mobile"></div>
        <div class="titulo_compartir"><b>IMPORTANTE</b></div>
        <div class="mensaje_alerta" id="mensajeInformacionEliminar"></div>
    </div>
</div>

<!-- POPUP OFERTA FINAL -->

<div class="contenedor_fondo_popup" id="popupOfertaFinal" style="display: none;">
    <div class="popup_ofertaFinal">
        <a class="cerrar_popMobile" href="javascript:;" id="lnkCerrarPopupOfertaFinal">
            <img src="/Content/Images/mobile/Esika/cerrar_04.png" alt="Cerrar">
        </a>
        <div id="divIconoOfertaFinal">
        </div>
        <h1 class="ofertaFinal_titulo">
            <span id="spnTituloOfertaFinal">GUARDASTE TU <b>PEDIDO CON ÉXITO !</b></span>
        </h1>

        <div class="ofertaFinal_descripcion">
            Agrega <span>@Model.Simbolo </span><span id="spnMontoFaltanteOfertaFinal"></span>
            <span id="spnMensajeOfertaFinal">para ganar más esta campaña.</span>
        </div>

        <div class="contenedor_carruselOfertaFinal">
            
            <div class="ofertaFinal_info">
                <span id="spnSubTituloOfertaFinal">Gana mas con estas ofertas que tenemos solo para ti</span>
            </div>

            <div class="bloque_carousel">
                @*<div class="btn_controles_carousel btn_control_atras">
                    <img src="@Url.Content("~/Content/Images/mobile/flecha-left.png")" alt="Atrás" />
                </div>*@
                <div class="slider center" id="divCarruselOfertaFinal" style="width: 100%">
                    
                </div>
            </div>

            <a href="#" title="NO, GRACIAS" class="enlace_btnNoGracias" id="btnNoGraciasOfertaFinal">
                NO, GRACIAS
            </a>
            
        </div>
    </div>
</div>

<!-- FIN POPUP OFERTA FINAL -->
@*<div id="popup-eliminar-mensaje" class="modal fade" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog modal-alert ">
            <div class="modal-content">
                <div class="modal-body">
                    <div id="mensajeInformacionEliminar" class="text-lg"></div>
                </div>
            </div>
        </div>
    </div>*@
<!-- END POPUP PERSONALIZADO 2 SEGUNDOS SE OCULTA -->
<!-- START Popup para Eliminar Todo Pedido -->
<div id="divConfirmEliminarTotal" class="MensajeAlertaMobile" style="display:none;">
    <div class="content_mensajeAlerta">
        <a class="cerrar_popMobile" href="javascript:;" onclick="EliminarPedidoTotalNo();">
            <img src="/Content/Images/mobile/Esika/cerrar_04.png" alt="-">
        </a>
        <hr class="clear">
        <div class="icono_alerta exclamacion_icono_mobile"></div>
        <div class="titulo_compartir"><b>IMPORTANTE</b></div>
        <div class="mensaje_alerta">¿Deseas eliminar el pedido completo?.</div>
        <a href="javascript:;" onclick="EliminarPedidoTotalSi();" class="btn_ok_mobile"><b>OK</b></a>
    </div>
</div>

<!--POP MENSAJE IMPORTANTE-->
<div id="popup-eliminar-item" class="MensajeAlertaMobile" style="display:none;">
    <div class="content_mensajeAlerta">
        <a class="cerrar_popMobile" href="javascript:;" onclick="javascript: $('#popup-eliminar-item').hide();">
            <img src="/Content/Images/mobile/Esika/cerrar_04.png" alt="-">
        </a>
        <hr class="clear">
        <div class="icono_alerta exclamacion_icono_mobile"></div>
        <div class="titulo_compartir"><b>IMPORTANTE</b></div>
        <div class="mensaje_alerta">¿Estás segura que quieres eliminar el producto?</div>
        <a href="javascript:;" onclick="ConfirmaEliminarPedido();" class="btn_ok_mobile"><b>OK</b></a>
    </div>
</div>
<!--FIN-->
<!--POP MENSAJE LO LOGRASTE-->
<div id="MensajeLograste" class="MensajeAlertaMobile" style="display:none;">
    <div class="content_mensajeAlerta">
        <a class="cerrar_popMobile" href="javascript:;" onclick="javascript: $('#MensajeLograste').hide();">
            <img src="/Content/Images/mobile/Esika/cerrar_04.png" alt="-">
        </a>
        <hr class="clear">
        <div class="icono_alerta check_icono_mobile"></div>
        <div class="titulo_compartir">¡LO <b>LOGRASTE</b>!</div>
        <div class="mensaje_alerta">Tu pedido fue guardado con éxito</div>
        <a class="btn_ok_mobile"><b>OK</b></a>
    </div>
</div>
<!--FIN-->

<input id="hdfPROLSinStock" type="hidden" value="0" />
<input id="hdfModificaPedido" type="hidden" value="0" />

<!--SB20-483 - INICIO -->

<!-- POPUP MIS GANANCIAS -->

<div class="contenedor_fondo_popup" id="popupGanancias" style="display:none;">
    <div class="popup_mis_ganancias">
        <div class="btn_cerrar_actualizarMisDatos">
            <a href="javascript:;" title="Cerrar" class="cerrar_tutorial" onclick="return $('#popupGanancias').fadeOut(200);">
                <img src="@Url.Content("~/Content/Images/btn_cerrar_popup.svg")" alt="Cerrar" />
                <span class="texto_btn_cerrar">CERRAR</span>
            </a>
        </div>
        <div class="contenido_misGanancias" id="detalleGanancia">
            <h6>GANANCIA ESTIMADA TOTAL</h6>
            <div class="mis_descuentos">
                <span class="mis_descuentos_texto">Mis descuentos</span>
                <span class="mis_descuentos_monto">@Model.Simbolo @ViewBag.MontoAhorroCatalogo</span>
            </div>
            <div class="mis_descuentos">
                <span class="mis_descuentos_texto">Oportunidad de ahorro (Revista y otros)</span>
                <span class="mis_descuentos_monto">@Model.Simbolo @ViewBag.MontoAhorroRevista</span>
            </div>
            <div class="separador_montos_misGanancias"></div>
            <div class="mis_descuentos">
                <span class="monto_total_misGanancias">@Model.Simbolo @ViewBag.GananciaEstimada</span>
            </div>
            <div class="nota_popup_misGanancias">
                <span>*Oportunidad de ahorro= ahorro estimado proveniente de la resta de los precios en catálogo de los productos menos el monto a pagar de los mismos.</span>
            </div>
        </div>
    </div>
</div>

<!-- FIN POPUP MIS GANANCIAS -->
<!--SB20-483 - FIN -->

<script id="template-Detalle" type="text/x-handlebars-template">
    @*<div style="position:relative; overflow:hidden;">*@
        @*<div class="textos_resumen" style="margin-left:-31px;">*@
        <div class="textos_resumen">

            @*<div class="separador_montos_mobile" style="left:2px; top:94px; width:100%;"></div>*@
            @*<span id="lblProductosResumen" style="margin-left:30px;">HE AGREGADO :</span>*@
            <span id="lblProductosResumen">HE AGREGADO :</span>
            @*<span style="margin-bottom: 8px; margin-left: 30px;">TOTAL SIN DSCTO. :</span>
            <span style="margin-bottom: 15px; margin-left: 30px;">DSCTO. OFERTAS <br />POR NIVELES :</span>*@
            @*<div style="margin-bottom: 8px; margin-left: 30px;">*@
            <span id="lblTotalResumen">
                MONTO TOTAL :
            </span>

             @{                                                              
                    string cabezaEscala=null, pieEscala=null;
                    string lbl1Ganancia = null, lbl2Ganancia = null;
                    
                    if (Model.CodigoISO == Constantes.CodigosISOPais.Peru ||
                                Model.CodigoISO == Constantes.CodigosISOPais.Colombia ||
                                Model.CodigoISO == Constantes.CodigosISOPais.Ecuador ||
                                Model.CodigoISO == Constantes.CodigosISOPais.Guatemala ||
                                Model.CodigoISO == Constantes.CodigosISOPais.Salvador ||
                                Model.CodigoISO == Constantes.CodigosISOPais.Dominicana ||
                                Model.CodigoISO == Constantes.CodigosISOPais.PuertoRico)    //PE,CO,EC,GT.SV,PR,DO
                    {
                        cabezaEscala = "Ganancia estimada total";
                        pieEscala = "*Ganancia Total = Ahorro estimado proveniente de tus descuentos por compras en catálogo + ahorro estimado proveniente de compras de Guía de Negocio y Otros.";
                        lbl1Ganancia = "Mis descuentos";
                        lbl2Ganancia = "Ganancia estimada *(Guia de negocio y otros)";
                    }
                    else if (Model.CodigoISO == Constantes.CodigosISOPais.Mexico || Model.CodigoISO == Constantes.CodigosISOPais.Panama)// MX,PA
                    {
                        cabezaEscala = "Ganancia estimada total";
                        pieEscala = "*Ganancia Total = Ahorro estimado proveniente de tus descuentos por compras en catálogo + ahorro estimado proveniente de compras en Revista y Otros.";
                        lbl1Ganancia = "Mis descuentos";
                        lbl2Ganancia = "Ganancia estimada *(Revista y otros)";
                    }
                    else if (Model.CodigoISO == Constantes.CodigosISOPais.Chile)// CH
                    {
                        cabezaEscala = "Comisión y ahorro total";
                        pieEscala = "*Comisión = Ganancia estimada proveniente de tus descuentos por compras en catálogo; <br>Ahorro = Ahorro estimado proveniente de compras de Guía de Negocio y Otros.";
                        lbl1Ganancia = "Mis descuentos (-)10% retencion comisión liquida";
                        lbl2Ganancia = "Ahorro estimado *(Guia de negocio y otros)";
                    }
                    else if (Model.CodigoISO == Constantes.CodigosISOPais.Venezuela)
                    {
                        cabezaEscala = "Oportunidad de ahorro total";
                        pieEscala = "Oportunidad de Ahorro Total = Ahorro estimado proveniente de sus descuentos por compras en catálogo + ahorro estimado proveniente de compras en Revista y Otros";
                        lbl1Ganancia = "Por tus compras de productos de catalogo";
                        lbl2Ganancia = "Por tus comprar de productos de revista";
                    }
                    else if (Model.CodigoISO == Constantes.CodigosISOPais.Bolivia)
                    {
                        cabezaEscala = "Ganancia total";
                        pieEscala = "Ganancia total = Ahorro estimado proveniente de sus descuentos por compras en catálogo + ahorro estimado proveniente de compras en Guía de Negocio y Otros";
                        lbl1Ganancia = "Mis descuentos";
                        lbl2Ganancia = "Ganancia estimada *(Guia de negocio y otros)";
                    }
                    else if (Model.CodigoISO == Constantes.CodigosISOPais.CostaRica)
                    {
                        cabezaEscala = "Oportunidad de ahorro total";
                        pieEscala = "Oportunidad de Ahorro Total = Ahorro estimado proveniente de sus descuentos por compras en catálogo + ahorro estimado proveniente de compras en Revista y Otros";
                        lbl1Ganancia = "Mis descuentos";
                        lbl2Ganancia = "Oportunidad de ahorro *(Revista y otros)";
                    }                                                                                                 
             }
                
                <input type="hidden" id="hdeCabezaEscala" value="@cabezaEscala" />
                <input type="hidden" id="hdePieEscala" value="@pieEscala" />
                <input type="hidden" id="hdeLbl1Ganancia" value="@lbl1Ganancia" />
                <input type="hidden" id="hdeLbl2Ganancia" value="@lbl2Ganancia" />

                <div class="mi_ganancia">
                    @*<div class="info_validado abrir_popupMisGanancias" onclick="MostrarDetalleGanancia()">
                        <img src="@Url.Content("~/Content/Images/Esika/info-copy.png")" />
                    </div>*@
                    @(cabezaEscala.ToUpper().Trim()) :
                </div>
        </div>
        <div class="montos_resumen">
            <span><b data-cantidadproducto="">{{this.TotalProductos}}</b>&nbsp;&nbsp;UNIDADES</span>
            <!--SB20-483 - INICIO -->
            @*<span><b>{{Simbolo}} {{FormatoTotal}}</b></span>
            <span style="margin-bottom:27px;"><b>{{Simbolo}} {{FormatoMontoDescuento}}</b></span>*@
            <!--SB20-483 - FIN -->
            <span><b>{{Simbolo}}&nbsp;&nbsp;</b><b data-pedidocondescuento="">{{FormatoTotalConDescuento}}</b></span>
            <span class="mi_ganancia"><b>{{Simbolo}}&nbsp;&nbsp;</b><b class="lblDescripcionGanancia" data-ganancia="">{{FormatoMontoGanancia}}</b></span>
        </div>
    @*</div>*@

        <div class="detalle_pedido_ingresado">
            <span class="titulo_detalle">DETALLE</span>
        </div>

        {{#IsNullOrEmpty this.MensajeCierreCampania '!='}}
        <div class="alert-top-icon text-success">
            @*<i class="icon-exclamation-circle"></i> <div id="divMensajeCierreCampania">{{MensajeCierreCampania}}</div>*@
        </div>
        {{/IsNullOrEmpty}}
        <div id="divContenidoDetalle">
            {{#each this.ListaDetalleModel as |detalle|}}
            <div class="contenedor_items_pedido">
                <div class="bloque_descripcion_items_ingresados">
                    <div class="descripcion_item_pedido">
                        <span class="mensaje_tipoProd">
                            {{#iff detalle.TipoPedido '==' 'M'}}
                            <br />
                            <span>App móvil</span>
                            {{/iff}}

                            {{#iff OrigenPedidoWeb '==' '@Constantes.OrigenPedidoWeb.DesktopPedidoOfertaFinal'}}
                            {{else if_eq OrigenPedidoWeb '@Constantes.OrigenPedidoWeb.MobilePedidoOfertaFinal'}}
                            {{else iff detalle.ConfiguracionOfertaID '==' @Constantes.TipoOferta.Liquidacion}}
                            <br />
                            <span>Oferta Liquidación</span>
                            {{else iff detalle.ConfiguracionOfertaID '==' @Constantes.TipoOferta.Flexipago}}
                            <br />
                            <span>Oferta Flexipago</span>
                            {{else iff detalle.TipoOfertaSisID '==' @Constantes.ConfiguracionOferta.ShowRoom}}
                            <br />
                            <span>Pre-venta Digital</span>
                            {{else}}
                            {{#IsNullOrEmpty detalle.DescripcionOferta '!='}}
                            <br />
                            {{#iff (UpperCase DescripcionOferta) 'Contains' 'OFERTA PARA TI'}}
                            {{else}}
                            <label for="{{detalle.DescripcionOferta}}">{{Replace (Replace detalle.DescripcionOferta '[' '') ']' ''}}</label>
                            {{/iff}}
                            {{/IsNullOrEmpty}}
                            {{/iff}}
                        </span>
                        <span class="cod_prod">{{detalle.CUV}}</span>
                        <span class="desc_prod">
                            {{#iff detalle.IndicadorMontoMinimo '==' 0}}
                            <span class="texto_rojo">*</span>
                            {{/iff}}
                            <span id="DescripcionProducto_{{detalle.PedidoDetalleID}}">{{Split detalle.DescripcionProd '|' 0}}</span>
                        </span>
                        {{#iff detalle.EsKitNueva '==' false}}
                        <span class="nom_cliente">Cliente: {{detalle.Nombre}}</span>
                        {{/iff}}
                    </div>

                    {{#if detalle.EsKitNueva}}
                    <div class="icono_kitNuevas">
                        <a href="javascript:;" title="Ver Info Kit Nuevas">
                            <img src="@Url.Content("~/Content/Images/Esika/info-copy.png")" alt="Ver Info Kit Nuevas" />
                        </a>
                        <div class="tooltip_kitNuevas">
                            <span class="icono_notaDemanda" style="display:inline-block;"></span>
                            <span class="texto_tooltipKitNuevas">
                                Este Kit se agrega automáticamente sólo en tu primer pedido.
                            </span>
                        </div>
                    </div>

                    @*<div class="icono_kitNuevas">
                        <a href="javascript:;">
                            <img src="@Url.Content("~/Content/Images/Esika/info-copy.png")" alt="Info Kit Nueva" />
                        </a>
                    </div>
                    <div class="tooltip_kitNuevas">
                        <span class="icono_advertencia_notificacion"></span>
                        <span class="texto_tooltipKitNuevas">
                            Este Kit se agrega automáticamente sólo en tu primer pedido.
                        </span>
                    </div>*@
                    {{else}}
                    <div class="icono_eliminar_item_pedido">
                        <a href="javascript:;" title="Eliminar" onclick="EliminarPedidoEvento(event)" data-pedidodetalleid="{{detalle.PedidoDetalleID}}">
                            <img src="@Url.Content("~/Content/Images/Esika/tacho-copy.png")" alt="Eliminar" />
                        </a>
                    </div>
                    {{/if}}
                </div>
                <div style="display: none;">
                    <input type="hidden" id="PrecioUnidad_{{detalle.PedidoDetalleID}}" name="PrecioUnidad_{{detalle.PedidoDetalleID}}" value="{{detalle.PrecioUnidad}}">
                    <input type="hidden" id="ClienteID_{{detalle.PedidoDetalleID}}" name="ClienteID_{{detalle.PedidoDetalleID}}" value="{{detalle.ClienteID}}">
                    <input type="hidden" id="ClienteNombre_{{detalle.PedidoDetalleID}}" name="ClienteNombre_{{detalle.PedidoDetalleID}}" value="{{detalle.Nombre}}">
                    <input type="hidden" id="CantidadTemporal_{{detalle.PedidoDetalleID}}" name="CantidadTemporal_{{detalle.PedidoDetalleID}}" value="{{detalle.Cantidad}}">

                    <input type="hidden" id="CampaniaID_{{detalle.PedidoDetalleID}}" name="CampaniaID_{{detalle.PedidoDetalleID}}" value="{{detalle.CampaniaID}}">
                    <input type="hidden" id="PedidoID_{{detalle.PedidoDetalleID}}" name="PedidoID_{{detalle.PedidoDetalleID}}" value="{{detalle.PedidoID}}">
                    <input type="hidden" id="TipoOfertaSisID_{{detalle.PedidoDetalleID}}" name="TipoOfertaSisID_{{detalle.PedidoDetalleID}}" value="{{detalle.TipoOfertaSisID}}">
                    <input type="hidden" id="CUV_{{detalle.PedidoDetalleID}}" name="CUV_{{detalle.PedidoDetalleID}}" value="{{detalle.CUV}}">

                    <input type="hidden" id="DescripcionProd_{{detalle.PedidoDetalleID}}" name="DescripcionProd_{{detalle.PedidoDetalleID}}" value="{{Split detalle.DescripcionProd '|' 0}}">
                    <input type="hidden" id="MarcaID_{{detalle.PedidoDetalleID}}" name="MarcaID_{{detalle.PedidoDetalleID}}" value="{{detalle.MarcaID}}">
                    <input type="hidden" id="DescripcionOferta_{{detalle.PedidoDetalleID}}" name="DescripcionOferta_{{detalle.PedidoDetalleID}}" value="{{detalle.DescripcionOferta}}">
                </div>
                <div class="bloque_cantidades_precios_items_ingresados">
                    <div class="contenedor_cantidadProductos">
                        <div data-cantidad-contenedor="">
                            @*<span class="signo_menos" data-cantidad-agregar="-">
                                <img src="/Content/Images/Mobile/Esika/menos.png">
                            </span>*@
                            <div class="campo_cantidadProductos">
                                {{#iff detalle.EsKitNueva '==' true}}
                                  <input type="tel"
                                   class="ValidaNumeral ValidaPasteNumeral"
                                       id="Cantidad_{{detalle.PedidoDetalleID}}"
                                       maxlength="2"
                                       name="Cantidad_{{detalle.PedidoDetalleID}}"
                                       value="{{detalle.Cantidad}}"
                                       data-pedidodetalleid="{{detalle.PedidoDetalleID}}"
                                       data-cantidad-input="-"
                                       readonly="readonly">
                                {{else iff detalle.TipoEstrategiaID '==' 1}}
                            <input type="tel"
                                   class="ValidaNumeral ValidaPasteNumeral"
                                       id="Cantidad_{{detalle.PedidoDetalleID}}"
                                       maxlength="2"
                                       name="Cantidad_{{detalle.PedidoDetalleID}}"
                                       value="{{detalle.Cantidad}}"
                                       data-pedidodetalleid="{{detalle.PedidoDetalleID}}"
                                       data-cantidad-input="-"
                                       readonly="readonly">
                                {{else}}
                            <input type="tel"
                                   class="ValidaNumeral ValidaPasteNumeral"
                                       id="Cantidad_{{detalle.PedidoDetalleID}}"
                                       maxlength="2"
                                       name="Cantidad_{{detalle.PedidoDetalleID}}"
                                       onblur="UpdateLiquidacionEvento(event)"
                                       onkeypress="return FuncionesGenerales.ValidarSoloNumeros(event);"
                                       value="{{detalle.Cantidad}}"
                                       data-pedidodetalleid="{{detalle.PedidoDetalleID}}"
                                       data-cantidad-input="-">
                                {{/iff}}
                            </div>
                            @*<span class="signo_mas" data-cantidad-agregar="+">
                                <img src="/Content/Images/Mobile/Esika/mas.png">
                            </span>*@
                            <div class="clear"></div>
                        </div>
                    </div>
                    <div class="precios_item">
                        <span class="precio_normal_pedido">
                            <span>{{../Simbolo}} {{detalle.FormatoPrecioUnidad}}</span>
                        </span>
                        <span class="precio_oferta_pedido">
                            <!-- ICONO ADVERTENCIA -->
                            {{#if ../EstadoSimplificacionCuv}}
                            {{#if detalle.IndicadorOfertaCUV}}
                            <span class="icon-advertencia"></span>
                            {{/if}}
                            {{/if}}
                            <!-- FIN ICONO ADVERTENCIA -->
                            <span>{{../Simbolo}} <label id="ImporteTotal_{{detalle.PedidoDetalleID}}">{{detalle.FormatoImporteTotal}}</label></span>
                        </span>
                    </div>
                </div>

                @*{{#if detalle.IndicadorOfertaCUV}}
                        {{#if detalle.PedidoConDescuentoCuv}}
                            <div class="alert-top-icon text-success">
                                <div class="text-left">
                                    El precio total no incluye el descuento para ofertas con más de
                                    un precio (1x, 2x). Al validar tu pedido, el sistema elegirá la
                                    mejor combinación de precios posibles para ti.
                                </div>
                            </div>
                        {{/if}}
                    {{/if}}*@

                {{#IsNullOrEmpty detalle.Mensaje '!='}}
                <div class="notificacion_productoAgotado">
                    <small>
                        {{#iff detalle.TipoObservacion '!=' 0}}
                        {{{Replace detalle.Mensaje '¿Deseas aceptar el reemplazo?' ''}}}
                        {{else}}
                        {{detalle.Mensaje}}
                        {{/iff}}
                    </small>
                </div>
                {{/IsNullOrEmpty}}
            </div>
            {{/each}}
        </div>

        <div class="separador"></div>
        @*<div style="position:relative;">*@
        <div style="margin-left: -28px;">

            @*<div class="textos_resumen" style="margin-left:-31px;">*@
            <div class="textos_resumen">
                @*<div class="separador_montos_mobile" style="left:2px; top:94px; width:100%;"></div>*@
                <span style="margin-left:30px;">HE AGREGADO :</span>
                <!-- SB20-483 - INICIO -->
                @*<span style="margin-bottom: 8px; margin-left: 30px;">TOTAL SIN DSCTO.:</span>
                <span style="margin-bottom: 15px; margin-left: 30px;">DSCTO. OFERTAS <br />POR NIVELES :</span>*@
                <!-- SB20-483 - FIN -->

                <span>
                    <div class="info_validado">
                        <img src="/Content/Images/Esika/info-copy.png" />
                        <!--TOOLTIP-->
                        <div class="tooltip_validado_importe">
                            <div class="left_reservado">
                                <div class="datos_Reservado">
                                    <span>Total sin Dscto. </span>
                                    <span>Dscto por niveles</span>
                                </div>
                            </div>
                            <div class="right_reservado">
                                <div class="datos_Reservado">
                                    <span data-pedidototal="">{{Simbolo}} {{FormatoTotal}}</span>
                                    <span data-montodescuento="">{{Simbolo}} {{#iff FormatoMontoDescuento '>' 0}}-{{/iff}}{{FormatoMontoDescuento}}</span>
                                </div>
                            </div>
                        </div>
                        <!--FIN-->
                    </div>
                    MONTO TOTAL :
                </span>


                @*<div style="margin-bottom: 8px; margin-left: 30px;">
                    MONTO TOTAL :
                </div>*@

                <div class="mi_ganancia" style="margin-left: 30px;">
                    @*<div class="info_validado abrir_popupMisGanancias">
                        <img src="@Url.Content("~/Content/Images/Esika/info-copy.png")" onclick="MostrarDetalleGanancia()" />
                    </div>*@
                    @(cabezaEscala) :
                </div>
            </div>

            <div class="montos_resumen">
                <span><b data-cantidadproducto="">{{TotalProductos}}</b>&nbsp;&nbsp;UNIDADES</span>
                <!-- SB20-483 - INICIO -->
                @*<span><b>{{Simbolo}} {{FormatoTotal}}</b></span>
                <span style="margin-bottom:27px;"><b>{{Simbolo}} {{FormatoMontoDescuento}}</b></span>*@
                <!-- SB20-483 - FIN -->
                <span><b>{{Simbolo}}&nbsp;&nbsp;</b><b data-pedidocondescuento="">{{FormatoTotalConDescuento}}</b></span>
                <span class="mi_ganancia"><b>{{Simbolo}}&nbsp;&nbsp;</b><b data-ganancia="">{{FormatoMontoGanancia}}</b></span>
            </div>
        </div>
       
        <div class="mensajes_adicionales_ingresoPedido" id="iconoAdvertenciaNotificacion" style="display: none;">
            <!-- ICONO ADVERTENCIA -->
            <span class="icono_advertencia_notificacion"></span>
            <!-- FIN ICONO ADVERTENCIA -->
            <span class="detalle_mensajeAdicional">
                El precio total no incluye el descuento para ofertas con más de un precio (1x, 2x).<br />
                Al validar tu pedido, el sistema elegirá la mejor combinación de precios posibles para ti.
            </span>
        </div>
        <div class="mensaje_eliminarPedido">
            <span>
                Para eliminar el pedido completo
                <a href="javascript:;" title="Haz click aquí" onclick="PedidoDetalleEliminarTodoConfirmar()">haz click aquí</a>
            </span>
        </div>
</script>


<!--SB20-565 - INICIO -->

<script id="ofertaFinal-template" type="text/x-handlebars-template">
    {{#each this}}
    <div class="content_item_carrusel_ofertaFinal" data-item="ofertaFinal">
        <div style="display: none;">
            <input type="hidden" class="hdOfertaFinalCuv" value="{{CUV}}" />
            <input type="hidden" class="hdOfertaFinalTipoOfertaSisID" value="{{TipoOfertaSisID}}" />
            <input type="hidden" class="hdOfertaFinalConfiguracionOfertaID" value="{{ConfiguracionOfertaID}}" />
            <input type="hidden" class="hdOfertaFinalIndicadorMontoMinimo" value="{{IndicadorMontoMinimo}}" />
            <input type="hidden" class="hdOfertaFinalTipo" value="1" />
            <input type="hidden" class="hdOfertaFinalMarcaID" value="{{MarcaID}}" />
            <input type="hidden" class="hdOfertaFinalPrecioUnidad" value="{{PrecioCatalogo}}" />
            <input type="hidden" class="hdOfertaFinalDescripcionProd" value="{{Descripcion}}" />
            <input type="hidden" class="hdOfertaFinalPagina" value="0" />
            <input type="hidden" class="hdOfertaFinalDescripcionCategoria" value="{{DescripcionCategoria}}" />
            <input type="hidden" class="hdOfertaFinalDescripcionMarca" value="{{DescripcionMarca}}" />
            <input type="hidden" class="hdOfertaFinalDescripcionEstrategia" value="{{DescripcionEstrategia}}" />
        </div>
        <div class="contenido_item_ofertaFinal">
            <div class="producto_img_home">
                <img src="{{ImagenProductoSugerido}}">
            </div>
            <div class="etiqueta_producto">
            </div>
            <div class="producto_nombre_descripcion">
                <h6>{{DescripcionMarca}}</h6>
                <p class="nombre_producto">
                    <b>{{Descripcion}}</b>
                </p>
                <div class="producto_precio">
                    <span class="producto_precio_normal" style="display:none;">{{Simbolo}} {{PrecioValorizadoString}}</span>
                    <span class="producto_precio_oferta"><b>{{Simbolo}} {{PrecioCatalogoString}}</b></span>
                </div>
                <div class="contenedor_cantidadProductos">
                    <span class="textoCantidad">CANTIDAD:</span>
                    <div>
                        @*<span class="signo_menos restar-uno" onclick="sumarUno(this);">
                            <img src="/Content/Images/Mobile/Esika/menos.png">
                        </span>
                        <div class="campo_cantidadProductos">
                            <input type="tel" name="cantidad" value="1" id="txtCantidad" min="1" max="99" maxlength="2" oninput="maxLengthCheck(this,2)" onkeypress="return FuncionesGenerales.ValidarSoloNumeros(event);" data-input="cantidad">
                        </div>
                        <span class="signo_mas sumar-uno" onclick="sumarUno(this);">
                            <img src="/Content/Images/Mobile/Esika/mas.png">
                        </span>*@
                        <a class="cantidad_menos_home"><img src="/Content/Images/Mobile/Esika/menos.png" alt=""></a>
                        <input type="tel" value="1" size="2" maxlength="2" id="txtCantidad" class="rango_cantidad_pedido ValidaNumeral ValidaPasteNumeral" onkeypress="return FuncionesGenerales.ValidarSoloNumeros(event);" data-input="cantidad">
                        <a class="cantidad_mas_home"><img src="/Content/Images/Mobile/Esika/mas.png" alt=""></a>
                        <div class="clear"></div>
                    </div>
                </div>
                <a class="boton_Agregalo_home agregarOfertaFinal">
                    AGRÉGALO
                </a>
                <div class="clear"></div>
            </div>
        </div>
    </div>
    {{/each}}
</script>
<!--SB20-565 - FIN -->


@section Scripts{
    <script type="text/javascript" src="@Url.Content("~/Scripts/handlebars.min.js")"></script>
    <script src="@Url.Content("~/Scripts/slick.min.js")"></script>

    <script type="text/javascript">

        var codigoIsoPais = '@Model.CodigoISO';
        var mensajeGuardarCO = '@Model.MensajeGuardarCO';
        var menuNotificaciones = '@ViewBag.MenuNotificaciones';
        var falgValidacionPedido = '@Model.FlagValidacionPedido';
        var ofertaLiquidacion = '@Constantes.ConfiguracionOferta.Liquidacion';
        var ofertaShowRoom = '@Constantes.ConfiguracionOferta.ShowRoom';
        var ofertaAccesorizate = '@Constantes.ConfiguracionOferta.Accesorizate';

        var urlEjecutarServicioPROL = '@Url.Action("EjecutarServicioPROL", "Pedido", new {area = ""})';
        var urlPedidoValidado = '@Url.Action("Validado", "Pedido", new {area = "Mobile"})';
        var urlHorarioRestringido = '@Url.Action("EnHorarioRestringido", "Pedido", new {area = ""})';

        var urlValidarUnidadesPermitidasPedidoProductoShowRoom = '@Url.Action("ValidarUnidadesPermitidasPedidoProducto", "ShowRoom", new {area = ""})';
        var urlObtenerStockActualProductoShowRoom = '@Url.Action("ObtenerStockActualProducto", "ShowRoom", new {area = ""})';
        var urlValidarUnidadesPermitidasPedidoProducto = '@Url.Action("ValidarUnidadesPermitidasPedidoProducto", "OfertaLiquidacion", new {area = ""})';
        var urlObtenerStockActualProducto = '@Url.Action("ObtenerStockActualProducto", "OfertaLiquidacion", new {area = ""})';
        var urlValidarUnidadesPermitidasPedidoProducto2 = '@Url.Action("ValidarUnidadesPermitidasPedidoProducto", "Accesorizate", new {area = ""})';
        var urlObtenerStockActualProducto2 = '@Url.Action("ObtenerStockActualProducto", "Accesorizate", new {area = ""})';

        var urlValidarStockEstrategia = '@Url.Action("ValidarStockEstrategia", "Pedido", new {area = ""})';
        var urlPedidoUpdate = '@Url.Action("Update", "Pedido", new {area = ""})';
        var urlPedidoDelete = '@Url.Action("Delete", "Pedido", new {area = ""})';
        var urlPedidoDeleteAll = '@Url.Action("DeleteAll", "Pedido", new { area = "" })';
        var urlInsertarDesglose = '@Url.Action("InsertarDesglose", "Pedido", new {area = ""})';
        var urlDeshacerReservaPedidoReservado = '@Url.Action("PedidoValidadoDeshacerReserva", "Pedido", new { area = "" })';

        var urlDetallePedido = '@Url.Action("CargarDetallePedido", "Pedido", new { area = "" })';
        var urlValidarKitNuevas = '@Url.Action("ValidarKitNuevas", "Pedido", new { area = "" })';
        var urlReservadoOEnHorarioRestringido = '@Url.Action("ReservadoOEnHorarioRestringido", "Pedido", new { area = "" })';
        var fnEliminarProducto = null;

        /* SB20-565 - INICIO */
        var listaEscalaDescuento = JSON.parse($("#hdListaEscala").val());
        var listaParametriaOfertaFinal = JSON.parse($("#hdListaParametriaOfertaFinal").val());

        var urlLoad = '@Url.Content("~/Content/Images/Loading.gif")';
        var viewBagPaisID = '@Model.PaisID';
        var viewBagNombrePais = '@ViewBag.NombrePais';
        var urlInsertar = '@Url.Action("Insert", "Pedido", new {area = ""})';
        /* SB20-565 - FIN */

    </script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/PortalConsultoras/Mobile/Pedido/Detalle.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Scripts/PortalConsultoras/Pedido/ofertaFinal.js")"></script>
}