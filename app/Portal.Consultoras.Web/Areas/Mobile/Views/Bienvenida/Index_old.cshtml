@using Portal.Consultoras.Common
@using Portal.Consultoras.Web.Areas.Mobile.Models

@model BienvenidaModel

@{
    Layout = "~/Areas/Mobile/Views/Shared/_MobileLayout.cshtml";

    var urlDomain = Util.GetUrlHost(Request);
}


@section styles{
    <style type="text/css">
        body {
            background: #FFF !important;
        }
    </style>
}

<div class="row">
    <div id="divDemandaAnticipada" class="alert alert-success alert-ads" style="display: none;">
        <button type="button" class="close" data-dismiss="alert" aria-hidden="true"></button>
        Pasa tu pedido por demanda anticipada y recibe<br>
        <ul>
            <li>Un Producto de regalo</li>
            <li>Flete gratis</li>
        </ul>
        <a href="#alert-collapse" data-toggle="collapse" class="pull-right upper">Ver Condiciones ></a>
        <div class="clearfix"></div>
        <div id="alert-collapse" class="collapse mt-10">
            Las condiciones para pasar tu pedido son: <br>
            <ul>
                <li>Cumplir con el monto mínimo (no cuenta expoferta) y máximo.</li>
                <li>Pasar tu pedido hasta el <span class="spanFechaDA"></span>.</li>
            </ul>
            <p>Recuerda que si aceptas participar no podrás modificar tu pedido luego del <span class="spanFechaDA"></span>.</p>
            <p class="text-center mt-30">
                <a href="javascript: InsertarDemandaAnticipada(1);" class="btn btn-alert-ads btn-round btn-sm">Acepto participar</a>
                <a href="javascript: InsertarDemandaAnticipada(0);" class="btn btn-alert-ads-outline btn-round btn-sm">No deseo participar</a>
            </p>
        </div>
    </div>
</div>

<div class="row">
    @if (Model.PortalLideres && Model.Lider == 1)
    {
        <div class="ws-home-1">
            <a href="@Url.Action("Index", "Lider", new {area = ""})" role="menu" region="Medio" parent="Socias empresarias" title="Socias empresarias" id="lnk-med-sociasempresarias" class="btn btn-link btn-link-double">
                @if (Model.NombrePais == "Venezuela")
                {
                    <span>IR A LIDERES</span>
                    <i class="icon-angle-next-belcorp"></i>
                }
                else
                {
                    <span>IR A SOCIAS EMPRESARIAS</span>
                    <i class="icon-angle-next-belcorp"></i>
                }
            </a>
        </div>
    }
    else
    {
        <br />
        <br />
    }

    <div class="ws-welcome-1 upper">
        <div class="ws-name">
            <span> @Model.Saludo.ToUpper() </span>
        </div>
    </div>

    <div class="ws-campana text-center">
        @if (string.IsNullOrEmpty(Model.NumeroCampania))
        {
            <p>
                <h4 class="text-primary">
                    La Zona @ViewBag.CodigoZona no se ubica en el cronograma, por favor contacte al Servicio de Atención al Cliente.
                </h4>
            </p>
        }
        else
        {
            <div class="text-ws">
                <small>Estás en</small> <br /> <span class="text-ws-lg">@string.Format("C{0}", Model.NumeroCampania)</span>
            </div>

            <div class="text-ws">
                @if (Model.DiasParaCierre == 0)
                {
                    <small>Tu cierre es</small><br />
                    <span class="text-ws-lg">Hoy</span>
                }
                else
                {
                    <small>Te quedan</small><br />
                    <span class="text-ws-lg">@Model.DiasParaCierre días</span>
                }
            </div>

            <div>
                <a href="@Url.Action("Index", "Pedido", new {area = "Mobile"})"
                   role="menu" region="Central" parent="Ingresa tu Pedido" title="Ingresa tu Pedido" id="lnk-cen-ingresa-tupedido"
                   class="btn btn-action-hover btn-round">
                    <i class="icon-shop-belcorp"></i>
                    INGRESA TU PEDIDO
                </a>
            </div>

            if (Model.IndicadorPermisoFIC == 1)
            {
                <br />
                <div>
                    <a href="@string.Format("{0}/Mobile/Menu/Ver?url=PedidoFIC", urlDomain)"
                       role="menu" region="Central" parent="Ingresa tu Pedido FIC" title="Ingresa tu Pedido FIC" id="lnk-cen-ingresa-tupedido-fic"
                       class="btn btn-line-action btn-wfijo btn-round">
                        INGRESA TU PEDIDO FIC
                    </a>
                </div>
            }
            if (Model.DiaPROL && Model.PROL1)
            {
                <br />
                <div>
                    <a href="@Url.Action("Detalle", "Pedido", new {area = "Mobile"})"
                       role="menu" region="Central" parent="Valida tu pedido" title="Valida tu pedido" id="lnk-cen-valida-tu-pedido"
                       class="btn btn-line-action btn-wfijo btn-round">
                        VALIDA TU PEDIDO
                    </a>
                </div>
            }
            else
            {
                <div id="divBtnVerPedido" style="display: none;">
                    <br />
                    <div>
                        <a href="@Url.Action("Detalle", "Pedido", new {area = "Mobile"})"
                           role="menu" region="Central" parent="Ver pedido" title="Ver pedido" id="lnk-cen-ver-pedido"
                           class="btn btn-line-action btn-wfijo btn-round">
                            VER MI PEDIDO
                        </a>
                    </div>
                </div>
            }
        }
    </div>

    @if (!string.IsNullOrEmpty(Model.NumeroCampania))
    {
        <div class="container-fluid">
            <div class="col-xs-12">
                <div class="simple-alert text-success">
                    <span class="alert-icon"><i class="icon-exclamation-circle"></i></span>
                    <div>@Model.MensajeCierreCampania</div>
                </div>
            </div>
        </div>

        if (Model.TieneFechaPromesa == 1)
        {
            <div class="container-fluid">
                <div class="col-xs-12">
                    <div class="label-gris-small">
                            <p>@Model.MensajeFechaPromesa</p>
                    </div>
                </div>
            </div>
        }
    }

    <div class="container-fluid">
        <div class="row">
            <div class="text-center">
                <div class=" col-xs-12">
                    <ul class="list-center">
                        @if (Model.InscritaFlexipago == "1")
                        {
                            <li>
                                <div id="spValorAPagar" class="text-lg text-info">
                                    <img alt="Cargando..." src="@Url.Content("~/Content/images/Loading.gif")" />
                                </div>
                                <div class="grey-box">TOTAL A PAGAR</div>
                            </li>
                            <li id="liFlexipagoMontoMinimo" style="display: none;">
                                <div id="divFlexipagoMontoMinimo" style="display: none;">
                                    <div id="spFlexipago" class="text-lg text-info">
                                        <img alt="Cargando..." src="@Url.Content("~/Content/images/Loading.gif")" />
                                    </div>
                                    <div class="grey-box">FLEXIPAGO – MÍNIMO VALOR A PAGAR:</div>
                                </div>
                            </li>
                            <li>
                                <div id="spPedidoWebAcumulado" class="text-lg text-info">
                                    <img alt="Cargando..." src="@Url.Content("~/Content/images/Loading.gif")" />
                                </div>
                                <div class="grey-box">PEDIDO WEB ACUMULADO</div>
                            </li>
                            <li>
                                <div id="spDeudaTotal" class="text-lg text-info">
                                    <img alt="Cargando..." src="@Url.Content("~/Content/images/Loading.gif")" />
                                </div>
                                <div class="grey-box">DEUDA TOTAL</div>
                            </li>
                        }
                        else
                        {
                            if (Model.IndicadorPermisoFIC == 0)
                            {
                                <li>
                                    <div id="spSaldoPendiente" class="text-lg text-info">
                                        <img alt="Cargando..." src="@Url.Content("~/Content/images/Loading.gif")" />
                                    </div>
                                    <div class="grey-box ">TOTAL A PAGAR</div>
                                </li>
                            }
                            <li>
                                <div id="spWebAcumulado" class="text-lg text-info">
                                    <img alt="Cargando..." src="@Url.Content("~/Content/images/Loading.gif")" />
                                </div>
                                <div class="grey-box">PEDIDO WEB ACUMULADO</div>
                            </li>
                        }
						<li id="liPedidosConsultoraOnline" style="display:none;">
                            <div id="divPedidosConsultoraOnline" class="text-lg text-info">
                            </div>
                            <div class="grey-box">CONSULTORA ONLINE</div>
                        </li>
                    </ul>
                </div>
                <div style="display: none;">
                    <div class="text-lg text-info">0</div>
                    <div class="grey-box ">PUNTOS BELCORP A C-@Model.NumeroCampania</div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-xs-12">
        <div class="list-table-new">
            <ul class="list-table-title upper">
                <li><strong>ENLACES DE INTERÉS</strong></li>
            </ul>
            <ul class="list-table-enlaceInteres">
                <li>
                    <a href="@Url.Action("Index", "EstadoCuenta", new { area = "Mobile" })"
                       role="menu" region="Enlaces de interés" parent="Mi Negocio" title="Estado de Cuenta" id="lnk-prin-estado-de-cuenta" target="_self">
                        <img class="" src="@Url.Content("~/Content/Images/mobile/img-icon/mobile_icon_mi_negocio.png")" alt="-" width="45" height="44" />
                        <span>Estado de Cuenta</span>
                        <span class="pull-right" style="padding-top: 10px;"><i class="icon-angle-next-belcorp"></i></span>
                    </a>
                </li>
                <li>
                    <a href="@Url.Action("Index", "SeguimientoPedido", new { area = "Mobile" })"
                       role="menu" region="Enlaces de interés" parent="Mi Negocio" title="Seguimiento a tu Pedido" id="lnk-prin-seguimiento-a-tu-pedido" target="_self">
                        <img class="" src="@Url.Content("~/Content/Images/mobile/img-icon/mobile_icon_seguimiento_pedidos.png")" alt="-" width="45" height="44" />
                        <span>Seguimiento a tu Pedido</span>
                        <span class="pull-right" style="padding-top: 10px;"><i class="icon-angle-next-belcorp"></i></span>
                    </a>
                </li>
                <li>
                    <a href="@Url.Action("Index", "Catalogo", new { area = "Mobile" })"
                       role="menu" region="Enlaces de interés" parent="Mis Catálogos y Revistas" title="Catálogos" id="lnk-prin-catalogos" target="_self">
                        <img class="" src="@Url.Content("~/Content/Images/mobile/img-icon/mobile_icon_mis_revistas.png")" alt="-" width="45" height="44" />
                        <span>Mis Catálogos</span>
                        <span class="pull-right" style="padding-top: 10px;"><i class="icon-angle-next-belcorp"></i></span>
                    </a>
                </li>
                <li>
                    <a href="@Url.Action("Index", "Revista", new { area = "Mobile" })"
                       role="menu" region="Enlaces de interés" parent="Mis Catálogos y Revistas" title="Revista Somos Belcorp" id="lnk-prin-revista-somos-belcorp" target="_self">
                        <img class="" src="@Url.Content("~/Content/Images/mobile/img-icon/mobile_icon_revista.png")" alt="-" width="45" height="44" />
                        <span>Revista Somos Belcorp</span>
                        <span class="pull-right" style="padding-top: 10px;"><i class="icon-angle-next-belcorp"></i></span>
                    </a>
                </li>

                @if (Model.NombrePais != "Venezuela")
                {
                    <li>
                        <a href="@Url.Action("Index", "OfertaLiquidacion", new { area = "Mobile" })"
                           role="menu" region="Enlaces de interés" parent="Mi Negocio" title="Zona de Liquidación" id="lnk-prin-zona-de-liquidacion" target="_self">
                            <img class="" src="@Url.Content("~/Content/Images/mobile/img-icon/mobile_icon_zona_liquidacion.png")" alt="-" width="45" height="44" />
                            <span>Zona de Liquidación</span>
                            <span class="pull-right" style="padding-top: 12px;"><i class="icon-angle-next-belcorp"></i></span>
                        </a>
                    </li>
                }
            </ul>
        </div>
    </div>
</div>

<div class="modal fade" id="PopShowroom">
    <div class="modal-dialog modal-alert" style="width:265px; margin:0 auto; margin-top:50px !important;">
        <div class="modal-content" style="float: right;width: 225px;padding:0;">
            <div class="modal-body" style="padding: 0; min-height: 384px;">
                <div id="btnCerrarPopShowroom" class="CerrarPopMobile"></div>
                <div class="pestana_pop_m">
                    <img src="@Url.Content("~/Content/Images/mobile/img-showroom/titulo_mobil.jpg")" alt="-" />
                </div>
                <div class="datos_pop_m">
                    <div class="nombre_separado_m"><span id="spnShowRoomNombreConsultora">María</span></div>
                    <div class="titulo_nombre_pop_m" style="width:21px"><img src="@Url.Content("~/Content/Images/mobile/img-showroom/deco_nombre.png")" alt=""></div>
                    <div class="titulo_nombre_pop_m" style="width:131px">te invitamos a la</div>
                    <div class="titulo_nombre_pop_m" style="width:21px"><img src="@Url.Content("~/Content/Images/mobile/img-showroom/deco_nombre.png")" alt=""></div>
                    <div class="titulo_preventa_m">PRE · VENTA</div>
                    <div class="titulo_digital_m">DIGITAL</div>
                    <div class="titulo_padre_m"><span id="spnShowRoomEvento">DÍA DEL PADRE</span></div>
                    <div class="fecha_promocion_m">Del <span id="spnShowRoomDiaInicio">XX</span> al <span id="spnShowRoomDiaFin">XX</span> de <span id="spnShowRoomMes">Junio</span></div>
                    <div class="img_pop_m"><img src="@Url.Content("~/Content/Images/mobile/img-showroom/exclusiva.png")" alt="-" /></div>
                    <div class="boton_cerrar_mobile"><a href="javascript:;" id="lnkConoceMasShowRoomPopup" target="_blank">CONOCE MÁS AQUÍ</a></div>
                    <div class="boton_desaparecer_pop"><a href="javascript:;" id="lnkNoMostrarPopup">No volver a ver éste comunicado</a></div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- modal popup HOY -->
<div class="modal fade" id="PopShowroomHoy">
    <div class="modal-dialog modal-alert" style="width:265px; margin:0 auto; margin-top:50px !important;">
        <div class="modal-content" style="float: right;width: 225px;padding:0;">

            <div class="modal-body" style="padding: 0; min-height: 420px;">
                <div id="btnCerrarPopShowroomHoy" class="CerrarPopMobile"></div>
                <div class="pestana_pop_m">
                    <img src="@Url.Content("~/Content/Images/mobile/img-showroom/titulo_mobil.jpg")" alt="-" />
                </div>
                <div class="datos_pop_m">
                    <div class="hoy_mobile"><img src="@Url.Content("~/Content/Images/mobile/img-showroom/Showroom-hoy.gif")" alt="-" /></div>
                    <div class="titulo_preventa_m">PRE · VENTA</div>
                    <div class="titulo_digital_m">DIGITAL</div>
                    <div class="titulo_padre_m"><span id="spnShowRoomEventoHoy">DÍA DEL PADRE</span></div>
                    <div class="img_pop_m">
                        <div class="imagen_set_pop_up"><img src="@Url.Content("~/Content/Images/mobile/img-showroom/set_hoy.png")" alt="-" /></div>
                        <div class="precio_hoy">SETS DESDE<br /><span>$5,990</span></div>
                    </div>
                    <hr class="clear" />
                    <div class="boton_cerrar_mobile"><a href="javascript:;" id="lnkConoceMasShowRoomPopupHoy">VER OFERTAS AQUÍ</a></div>
                    <div class="boton_desaparecer_pop"><a href="javascript:;" id="lnkNoMostrarPopupHoy">No volver a ver éste comunicado</a></div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end modal -->

@section scripts
{
    <script type="text/javascript">

        ////////

        $(document).ready(function () {

            $('.zonaliquidacion').on('click', function () {
                
                if (ReservadoOEnHorarioRestringido())
                    return;
                $(this)[0].attributes[0].value = '@Url.Action("Index", "OfertaLiquidacion", new { area = "Mobile" })';
                
            });

        });

   

        function ReservadoOEnHorarioRestringido(mostrarAlerta) {
            mostrarAlerta = typeof mostrarAlerta !== 'undefined' ? mostrarAlerta : true;
            var restringido = true;

            $.ajaxSetup({ cache: false });
            jQuery.ajax({
                type: 'GET',
                url: '@Url.Action("ReservadoOEnHorarioRestringido", "Pedido", new { area = "" })',
                dataType: 'json',
                contentType: 'application/json; charset=utf-8',
                async: false,
                success: function (data) {
                    
                    if (checkTimeout(data)) {
                        if (data.success == false)
                            restringido = false;
                        else {

                            if (data.pedidoReservado) {
                                var fnRedireccionar = function () {
                                    ShowLoading();
                                    location.href = '@Url.Action("Validado", "Pedido", new { area = "Mobile" })';
                                }
                                if (mostrarAlerta == true) {
                                    CloseLoading();
                                    alert_msg(data.message, fnRedireccionar);
                                }

                                else fnRedireccionar();

                            }
                            else if (mostrarAlerta == true) alert_msg(data.message);
                        }
                    }
                },
                error: function (error) {
                    console.log(error);
                    alert_msg('Ocurrió un error al intentar validar el horario restringido o si el pedido está reservado. Por favor inténtelo en unos minutos.');
                }
            });
            return restringido;
        }

        function alert_msg(message, fnClose) {
            messageInfo('<h3 class="text-primary">' + message + '</h3>', fnClose);

        }

        ////////


        $(function () {
            MostrarDemandaAnticipada();
            CargarMontosCampana();
            CrearPopShow();
            MostrarShowRoom();
        });


        function CrearPopShow() {
            $("#btnCerrarPopShowroom").click(function() {
                $("#PopShowroom").modal("hide");
            });
            
            $("#btnCerrarPopShowroomHoy").click(function () {
                $("#PopShowroomHoy").modal("hide");
            });

            $("#lnkNoMostrarPopup, #lnkNoMostrarPopupHoy").click(function () {
                var params = { noMostrarPopup: true };

                $.ajax({
                    type: "POST",
                    url: '@Url.Action("UpdatePopupShowRoom", "ShowRoom", new {area = ""})',
                    data: JSON.stringify(params),
                    contentType: 'application/json',
                    success: function(data) {
                        if (checkTimeout(data)) {
                            $("#PopShowroom").modal("hide");
                            $("#PopShowroomHoy").modal("hide");
                            AgregarTagManagerShowRoomCheckBox();
                        }
                    },
                    error: function(data, error) {
                        if (checkTimeout(data)) {
                            messageInfo("Ocurrió un error al intentar no mostrar el popup de showroom.");
                        }
                    }
                });
            });
            
            $("#lnkConoceMasShowRoomPopup").click(function() {
                AgregarTagManagerShowRoomPopupConocesMas(false);
            });
            
            $("#lnkConoceMasShowRoomPopupHoy").click(function () {
                AgregarTagManagerShowRoomPopupConocesMas(true);
            });
        }

        function MostrarShowRoom() {
            $.ajax({
                type: "POST",
                url: '@Url.Action("MostrarShowRoomPopup", "Bienvenida", new {area = ""})',
                contentType: 'application/json',
                success: function(response) {
                    if (checkTimeout(response)) {
                        if (response.success) {
                            var showroomConsultora = response.data;
                            var evento = response.evento;

                            if (showroomConsultora.EventoConsultoraID != 0) {
                                if (showroomConsultora.MostrarPopup) {
                                    $("#hdEventoIDShowRoom").val(evento.EventoID);
                                    
                                    if (response.mostrarShowRoomProductos) {
                                        $("#spnShowRoomEventoHoy").html(evento.Nombre);
                                        $("#spnShowRoomDiaInicioHoy").html(response.diaFin - 2);
                                        $("#spnShowRoomDiaFinHoy").html(response.diaFin);
                                        $("#spnShowRoomMesHoy").html(response.mesFin);
                                        
                                        $("#PopShowroomHoy").modal("show");
                                        $("#lnkConoceMasShowRoomPopupHoy").attr("href", '@Url.Action("Index", "ShowRoom", new {area = "Mobile"})');
                                        
                                        AgregarTagManagerShowRoomPopup(evento.Nombre, true);
                                    } else {
                                    $("#spnShowRoomNombreConsultora").html(response.nombre);
                                    $("#spnShowRoomEvento").html(evento.Nombre);
                                    $("#spnShowRoomDiaInicio").html(response.diaFin - 2);
                                    $("#spnShowRoomDiaFin").html(response.diaFin);
                                    $("#spnShowRoomMes").html(response.mesFin);

                                    $("#PopShowroom").modal("show");
                                        $("#lnkConoceMasShowRoomPopup").attr("href", response.rutaShowRoomPopup);

                                        AgregarTagManagerShowRoomPopup(evento.Nombre, false);
                                    }                                    
                                    
                                    //$("#imgShowRoomGif").attr("src", evento.Imagen1);                                                                                                                                                
                                }
                            }
                        }
                    }
                },
                error: function(response, error) {
                    if (checkTimeout(response)) messageInfo("Ocurrió un error al validar showroom.");
                }
            });
        }
        
        function AgregarTagManagerShowRoomPopup(nombreEvento, esHoy) {
            var name = 'showroom digital ' + nombreEvento;

            if (esHoy)
                name += " - fase 2";

            dataLayer.push({
                'event': 'promotionView',
                'ecommerce': {
                    'promoView': {
                        'promotions': [
                        {
                            'id': $("#hdEventoIDShowRoom").val(),
                                'name': name,
                                'position': 'Home pop-up - 1',
                            'creative': 'Banner'
                        }]
                    }
                }
            });
        }
        
        function AgregarTagManagerShowRoomPopupConocesMas(esHoy) {
            var name = 'showroom digital ' + $("#spnShowRoomEvento").html();

            if (esHoy)
                name += " - fase 2";

            dataLayer.push({
                'event': 'promotionClick',
                'ecommerce': {
                    'promoClick': {
                        'promotions': [
                            {
                                'id': $("#hdEventoIDShowRoom").val(),
                                'name': name,
                                'position': 'Home pop-up - 1',
                                'creative': 'Banner'
                            }]
                    }
                }
            });
        }
        
        function AgregarTagManagerShowRoomCheckBox() {
            dataLayer.push({
                'event': 'virtualEvent',
                'category': 'Ofertas Showroom',
                'action': 'checkbox',
                'label': '(not available)'
            });
        }

        function MostrarDemandaAnticipada() {
            $("#divDemandaAnticipada").hide();
            $.ajax({
                type: "POST",
                url: '@Url.Action("ValidacionConsultoraDA", "Bienvenida", new {area = "Mobile"})',
                contentType: 'application/json',
                success: function(data) {
                    if (checkTimeout(data)) {
                        if (data.success == true) {
                            $('.spanFechaDA').append(data.mensajeFechaDA);
                            $("#divDemandaAnticipada").show();
                        }
                    }
                },
                error: function(data, error) {
                    if (checkTimeout(data)) messageInfo("Ocurrió un error al validar demanda anticipada.");
                }
            });
        }

        function CargarMontosCampana() {
            $.ajax({
                type: 'GET',
                url: '@Url.Action("GetResumenCampania", "GestionContenido", new {area = ""})',
                cache: false,
                dataType: 'Json',
                success: function(data) {
                    if (checkTimeout(data)) {
                        if (data.result) {

                            if (data.listaProductosSolicitados.length > 0) {
                                var cantidadProductos = 0;
                                for (i = 0; i < data.listaProductosSolicitados.length; i++) {
                                    cantidadProductos += data.listaProductosSolicitados[i].Cantidad;
                                }
                                if (cantidadProductos > 0) {
                                    $("#divBtnVerPedido").show();
                                }
                            }

                            if ('@Model.InscritaFlexipago' == "1") {
                                if (data.listaValorApagar.length > 0) {
                                    if (data.listaValorApagar[0].ImporteTotal == '-1') {
                                        $("#spValorAPagar").text('No Aplica');
                                    } else if (data.listaValorApagar[0].ImporteTotal == '-2') {
                                        $("#spValorAPagar").text('Pagado');
                                    } else {
                                        switch (data.paisID) {
                                            case 4:
                                                $("#spValorAPagar").text(data.Simbolo + " " + SeparadorMiles(data.listaValorApagar[0].ImporteTotal.toFixed(0)));
                                                break;
                                            default:
                                                $("#spValorAPagar").text(data.Simbolo + " " + data.listaValorApagar[0].ImporteTotal.toFixed(2));
                                                break;
                                        }
                                    }
                                }
                            }

                            if ('@Model.InscritaFlexipago' == '1') {
                                if (data.listaWebAcumulado.length > 0) {
                                    if (data.paisID == '4') { // validación colombia
                                        $("#spPedidoWebAcumulado").text(data.Simbolo + " " + SeparadorMiles(data.listaWebAcumulado[0].ImporteTotal.toFixed(0)));
                                    } else {
                                        $("#spPedidoWebAcumulado").text(data.Simbolo + " " + data.listaWebAcumulado[0].ImporteTotal.toFixed(2));
                                    }
                                }
                            } else {
                                $("#spWebAcumulado").text(data.Simbolo + " " + data.listaWebAcumulado[0].ImporteTotal.toFixed(2));
                            }

                            if ('@Model.InscritaFlexipago' == '1') {
                                if (data.listaSaldoPendiente.length > 0) {
                                    if (data.paisID == '4') { // validación colombia
                                        $("#spDeudaTotal").text(data.Simbolo + " " + SeparadorMiles(data.listaSaldoPendiente[0].SaldoPendiente.toFixed(0)));
                                    } else {
                                        $("#spDeudaTotal").text(data.Simbolo + " " + data.listaSaldoPendiente[0].SaldoPendiente.toFixed(2));
                                    }
                                }
                            } else {
                                $("#spSaldoPendiente").text(data.Simbolo + " " + data.listaSaldoPendiente[0].SaldoPendiente.toFixed(2));
                            }

                            if ('@Model.InscritaFlexipago' == '1') {
                                switch (data.paisID) {
                                case 4:
//CO
                                case 11:
//PE
                                case 3:
//DO
                                        if (data.Flexipago[0].ImporteTotal === null || data.Flexipago[0].ImporteTotal === undefined || data.Flexipago[0].ImporteTotal === "") {
                                            $("#liFlexipagoMontoMinimo").css("display", "block");
                                            $("#divFlexipagoMontoMinimo").css("display", "block");
                                            $("#spFlexipago").text('');
                                    } else if (data.Flexipago[0].ImporteTotal == '-1') {
                                            $("#liFlexipagoMontoMinimo").css("display", "block");
                                            $("#divFlexipagoMontoMinimo").css("display", "block");
                                            $("#spFlexipago").text('No Aplica');
                                    } else if (data.Flexipago[0].ImporteTotal == '-2') {
                                            $("#liFlexipagoMontoMinimo").css("display", "block");
                                            $("#divFlexipagoMontoMinimo").css("display", "block");
                                            $("#spFlexipago").text('Pagado');
                                    } else {
                                            if (data.paisID == '4') { // validación colombia
                                                $("#liFlexipagoMontoMinimo").css("display", "block");
                                                $("#divFlexipagoMontoMinimo").css("display", "block");
                                                $("#spFlexipago").text(data.Simbolo + " " + SeparadorMiles(data.Flexipago[0].ImporteTotal.toFixed(0)));
                                        } else {
                                                $("#liFlexipagoMontoMinimo").css("display", "block");
                                                $("#divFlexipagoMontoMinimo").css("display", "block");
                                                $("#spFlexipago").text(data.Simbolo + " " + data.Flexipago[0].ImporteTotal.toFixed(2));
                                            }
                                        }
                                        break;
                                    default:
                                        var ul = $("ul.list-center");
                                        var html = '';
                                        html += '<li id="liMmoTotalFlexipago">';
                                        html += '<div id="spMmoTotalPagar" class="text-lg text-info">';
                                        html += data.Simbolo + " " + data.MontosFlexipago[0].MontoMinimoFlexipago.toFixed(2);
                                        html += '</div>';
                                        html += '<div class="grey-box">FLEXIPAGO – MÍNIMO VALOR A PAGAR:</div>';
                                        html += '</div>';
                                        html += '</li>';
                                        $(html).appendTo(ul);
                                }
                            }
                        } else {
                            messageInfo("Ocurrio un error con el Resumen de Campaña, vuelva a ingresar nuevamente.");
                            return false;
                        }
                    }
                }
            });
        }

        // Función que colocará el caracter "." como separador de miles.

        function SeparadorMiles(pnumero) {
            var resultado = "";
            var numero = pnumero.replace(/\,/g, '');
            var nuevoNumero = "";
            if (numero[0] == "-") nuevoNumero = numero.replace(/\./g, '').substring(1);
            else nuevoNumero = numero.replace(/\./g, '');

            if (numero.indexOf(",") >= 0) nuevoNumero = nuevoNumero.substring(0, nuevoNumero.indexOf(","));

            for (var j, i = nuevoNumero.length - 1, j = 0; i >= 0; i--, j++)
                resultado = nuevoNumero.charAt(i) + ((j > 0) && (j % 3 == 0) ? "." : "") + resultado;

            if (numero.indexOf(",") >= 0) resultado += numero.substring(numero.indexOf(","));

            if (numero[0] == "-") return "-" + resultado;
            else return resultado;
        }

        function InsertarDemandaAnticipada(tipo) {
            ShowLoading();
            var params = { tipoConfiguracion: tipo };

            $.ajax({
                type: "POST",
                url: '@Url.Action("InsConfiguracionConsultoraDA", "Cronograma", new {area = ""})',
                data: JSON.stringify(params),
                contentType: 'application/json',
                success: function(data) {
                    if (checkTimeout(data)) {
                        if (data.success == true) location.href = '@Url.Action("LoginCargarConfiguracion", "Login", new {area = ""})?paisID=' + data.paisID + '&codigoUsuario=' + data.codigoUsuario;
                        else CloseLoading();
                    }
                },
                error: function(data, error) {
                    if (checkTimeout(data)) {
                        CloseLoading();
                        if (tipo == 1) messageInfo("Ocurrió un error al aceptar la demanda anticipada.");
                        else messageInfo("Ocurrió un error al cancelar la demanda anticipada.");
                    }
                }
            });
        }
		
        $(document).ajaxStop(function() {
            MostrarMensajeConsultoraOnline();
        });

        function MostrarMensajeConsultoraOnline() {
            var cantidadPedidosOnline = parseInt($("#divPedidosOnlineSinLeer").html());

            if (!isNaN(cantidadPedidosOnline) && cantidadPedidosOnline != -1) {

                if (cantidadPedidosOnline == 1) {
                    $("#divPedidosConsultoraOnline").html(cantidadPedidosOnline + " <span style='font-size: 0.7em;'>PEDIDO</span>");
                } else {
                    $("#divPedidosConsultoraOnline").html(cantidadPedidosOnline + " <span style='font-size: 0.7em;'>PEDIDOS</span>");
                }
                $("#liPedidosConsultoraOnline").show();
            }
        }

    </script>
}